{
  "hash": "21a17b78977cd1ca4b7ed64dfeaec855",
  "result": {
    "markdown": "---\ntitle: \"Cause-Deleted Life Tables\"\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\n\n# Introduction \n\n[Code inspiration](https://grodri.github.io/demography/neoplasms)\n[Additional code](http://www.ub.edu/rfa/R/life_tables.html)\n\n# Construct a Life Table\n\n\n::: {#tbl-life-table .cell tbl-cap='Life Table'}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Source URL: https://grodri.github.io/demography/periodlt\nurl <- \"https://grodri.github.io/datasets/preston31.dat\"\nb31 <- read.table(url, header=FALSE)\nnames(b31) = c(\"age\",\"N\",\"D\")\nb31 <- b31_ <- \n    b31 %>% \n    inner_join(haven::read_dta(\"https://grodri.github.io/datasets/kfnax.dta\"), kfnax, by=\"age\") %>% \n    mutate(n = c(diff(age),0),\n           m = D / N) %>% \n    rename(a = nax) \n\ncond <- rep(b31[1,\"m\"] >= 0.107, 2) # condition must be a vector here\nb31[1:2,\"a\"] <- ifelse(cond, c(0.330, 1.352) ,\n  b31[1:2,\"a\"] <- c(0.045, 1.651) + c(2.684, -2.816)* b31[1,\"m\"])\nlast <- nrow(b31)\nb31[last,\"a\"] <- 1/ b31[last,\"m\"]\nb31 <- b31 %>% \n    mutate(q = n * m/(1 + (n - a) * m), p = 1 - q)\nb31[last, c(\"q\",\"p\")] = c(1,0)\nb31 <- \n    b31 %>% \n    mutate(lx = 100000 * cumprod( c(1, p[-last])),\n           d = c(-diff(lx), lx[last]),\n           L =  (lx - d) * n +  d * a) %>% \n    mutate(T = sum(L) - cumsum(L) + L,\n           e = T/lx)\n\nb31 %>% \n    kable() %>% \n    kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> N </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> a </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> m </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> lx </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> L </th>\n   <th style=\"text-align:right;\"> T </th>\n   <th style=\"text-align:right;\"> e </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 47925 </td>\n   <td style=\"text-align:right;\"> 419 </td>\n   <td style=\"text-align:right;\"> 0.06847 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.00874 </td>\n   <td style=\"text-align:right;\"> 0.00867 </td>\n   <td style=\"text-align:right;\"> 0.99133 </td>\n   <td style=\"text-align:right;\"> 100000 </td>\n   <td style=\"text-align:right;\"> 867.220 </td>\n   <td style=\"text-align:right;\"> 99192 </td>\n   <td style=\"text-align:right;\"> 7288901 </td>\n   <td style=\"text-align:right;\"> 72.8890 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 189127 </td>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 1.62638 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.00037 </td>\n   <td style=\"text-align:right;\"> 0.00148 </td>\n   <td style=\"text-align:right;\"> 0.99852 </td>\n   <td style=\"text-align:right;\"> 99133 </td>\n   <td style=\"text-align:right;\"> 146.636 </td>\n   <td style=\"text-align:right;\"> 396183 </td>\n   <td style=\"text-align:right;\"> 7189709 </td>\n   <td style=\"text-align:right;\"> 72.5260 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 234793 </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 2.50000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 0.00077 </td>\n   <td style=\"text-align:right;\"> 0.99923 </td>\n   <td style=\"text-align:right;\"> 98986 </td>\n   <td style=\"text-align:right;\"> 75.857 </td>\n   <td style=\"text-align:right;\"> 494741 </td>\n   <td style=\"text-align:right;\"> 6793526 </td>\n   <td style=\"text-align:right;\"> 68.6311 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 238790 </td>\n   <td style=\"text-align:right;\"> 46 </td>\n   <td style=\"text-align:right;\"> 3.14300 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00019 </td>\n   <td style=\"text-align:right;\"> 0.00096 </td>\n   <td style=\"text-align:right;\"> 0.99904 </td>\n   <td style=\"text-align:right;\"> 98910 </td>\n   <td style=\"text-align:right;\"> 95.235 </td>\n   <td style=\"text-align:right;\"> 494375 </td>\n   <td style=\"text-align:right;\"> 6298785 </td>\n   <td style=\"text-align:right;\"> 63.6818 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 254996 </td>\n   <td style=\"text-align:right;\"> 249 </td>\n   <td style=\"text-align:right;\"> 2.72400 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00098 </td>\n   <td style=\"text-align:right;\"> 0.00487 </td>\n   <td style=\"text-align:right;\"> 0.99513 </td>\n   <td style=\"text-align:right;\"> 98815 </td>\n   <td style=\"text-align:right;\"> 481.388 </td>\n   <td style=\"text-align:right;\"> 492980 </td>\n   <td style=\"text-align:right;\"> 5804410 </td>\n   <td style=\"text-align:right;\"> 58.7401 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 326831 </td>\n   <td style=\"text-align:right;\"> 420 </td>\n   <td style=\"text-align:right;\"> 2.52000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00129 </td>\n   <td style=\"text-align:right;\"> 0.00640 </td>\n   <td style=\"text-align:right;\"> 0.99360 </td>\n   <td style=\"text-align:right;\"> 98334 </td>\n   <td style=\"text-align:right;\"> 629.820 </td>\n   <td style=\"text-align:right;\"> 490106 </td>\n   <td style=\"text-align:right;\"> 5311431 </td>\n   <td style=\"text-align:right;\"> 54.0144 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 355086 </td>\n   <td style=\"text-align:right;\"> 403 </td>\n   <td style=\"text-align:right;\"> 2.48100 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00113 </td>\n   <td style=\"text-align:right;\"> 0.00566 </td>\n   <td style=\"text-align:right;\"> 0.99434 </td>\n   <td style=\"text-align:right;\"> 97704 </td>\n   <td style=\"text-align:right;\"> 552.858 </td>\n   <td style=\"text-align:right;\"> 487127 </td>\n   <td style=\"text-align:right;\"> 4821324 </td>\n   <td style=\"text-align:right;\"> 49.3463 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 324222 </td>\n   <td style=\"text-align:right;\"> 441 </td>\n   <td style=\"text-align:right;\"> 2.60100 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00136 </td>\n   <td style=\"text-align:right;\"> 0.00678 </td>\n   <td style=\"text-align:right;\"> 0.99322 </td>\n   <td style=\"text-align:right;\"> 97151 </td>\n   <td style=\"text-align:right;\"> 658.565 </td>\n   <td style=\"text-align:right;\"> 484175 </td>\n   <td style=\"text-align:right;\"> 4334198 </td>\n   <td style=\"text-align:right;\"> 44.6130 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 269963 </td>\n   <td style=\"text-align:right;\"> 508 </td>\n   <td style=\"text-align:right;\"> 2.70100 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00188 </td>\n   <td style=\"text-align:right;\"> 0.00937 </td>\n   <td style=\"text-align:right;\"> 0.99063 </td>\n   <td style=\"text-align:right;\"> 96492 </td>\n   <td style=\"text-align:right;\"> 903.957 </td>\n   <td style=\"text-align:right;\"> 480384 </td>\n   <td style=\"text-align:right;\"> 3850023 </td>\n   <td style=\"text-align:right;\"> 39.8997 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 261971 </td>\n   <td style=\"text-align:right;\"> 769 </td>\n   <td style=\"text-align:right;\"> 2.66300 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00294 </td>\n   <td style=\"text-align:right;\"> 0.01458 </td>\n   <td style=\"text-align:right;\"> 0.98542 </td>\n   <td style=\"text-align:right;\"> 95588 </td>\n   <td style=\"text-align:right;\"> 1393.412 </td>\n   <td style=\"text-align:right;\"> 474686 </td>\n   <td style=\"text-align:right;\"> 3369639 </td>\n   <td style=\"text-align:right;\"> 35.2515 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 238011 </td>\n   <td style=\"text-align:right;\"> 1154 </td>\n   <td style=\"text-align:right;\"> 2.69800 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00485 </td>\n   <td style=\"text-align:right;\"> 0.02397 </td>\n   <td style=\"text-align:right;\"> 0.97603 </td>\n   <td style=\"text-align:right;\"> 94195 </td>\n   <td style=\"text-align:right;\"> 2258.325 </td>\n   <td style=\"text-align:right;\"> 465777 </td>\n   <td style=\"text-align:right;\"> 2894953 </td>\n   <td style=\"text-align:right;\"> 30.7336 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 261612 </td>\n   <td style=\"text-align:right;\"> 1866 </td>\n   <td style=\"text-align:right;\"> 2.67600 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00713 </td>\n   <td style=\"text-align:right;\"> 0.03508 </td>\n   <td style=\"text-align:right;\"> 0.96492 </td>\n   <td style=\"text-align:right;\"> 91937 </td>\n   <td style=\"text-align:right;\"> 3225.321 </td>\n   <td style=\"text-align:right;\"> 452188 </td>\n   <td style=\"text-align:right;\"> 2429176 </td>\n   <td style=\"text-align:right;\"> 26.4223 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 181385 </td>\n   <td style=\"text-align:right;\"> 2043 </td>\n   <td style=\"text-align:right;\"> 2.64500 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01126 </td>\n   <td style=\"text-align:right;\"> 0.05486 </td>\n   <td style=\"text-align:right;\"> 0.94514 </td>\n   <td style=\"text-align:right;\"> 88711 </td>\n   <td style=\"text-align:right;\"> 4866.838 </td>\n   <td style=\"text-align:right;\"> 432096 </td>\n   <td style=\"text-align:right;\"> 1976988 </td>\n   <td style=\"text-align:right;\"> 22.2856 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 187962 </td>\n   <td style=\"text-align:right;\"> 3496 </td>\n   <td style=\"text-align:right;\"> 2.62400 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01860 </td>\n   <td style=\"text-align:right;\"> 0.08906 </td>\n   <td style=\"text-align:right;\"> 0.91094 </td>\n   <td style=\"text-align:right;\"> 83845 </td>\n   <td style=\"text-align:right;\"> 7467.337 </td>\n   <td style=\"text-align:right;\"> 401480 </td>\n   <td style=\"text-align:right;\"> 1544893 </td>\n   <td style=\"text-align:right;\"> 18.4257 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> 153832 </td>\n   <td style=\"text-align:right;\"> 4366 </td>\n   <td style=\"text-align:right;\"> 2.61900 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.02838 </td>\n   <td style=\"text-align:right;\"> 0.13293 </td>\n   <td style=\"text-align:right;\"> 0.86707 </td>\n   <td style=\"text-align:right;\"> 76377 </td>\n   <td style=\"text-align:right;\"> 10152.475 </td>\n   <td style=\"text-align:right;\"> 357713 </td>\n   <td style=\"text-align:right;\"> 1143412 </td>\n   <td style=\"text-align:right;\"> 14.9706 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 105169 </td>\n   <td style=\"text-align:right;\"> 4337 </td>\n   <td style=\"text-align:right;\"> 2.59300 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.04124 </td>\n   <td style=\"text-align:right;\"> 0.18757 </td>\n   <td style=\"text-align:right;\"> 0.81243 </td>\n   <td style=\"text-align:right;\"> 66225 </td>\n   <td style=\"text-align:right;\"> 12421.994 </td>\n   <td style=\"text-align:right;\"> 301224 </td>\n   <td style=\"text-align:right;\"> 785699 </td>\n   <td style=\"text-align:right;\"> 11.8641 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 73694 </td>\n   <td style=\"text-align:right;\"> 5279 </td>\n   <td style=\"text-align:right;\"> 2.51800 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.07163 </td>\n   <td style=\"text-align:right;\"> 0.30410 </td>\n   <td style=\"text-align:right;\"> 0.69590 </td>\n   <td style=\"text-align:right;\"> 53803 </td>\n   <td style=\"text-align:right;\"> 16361.539 </td>\n   <td style=\"text-align:right;\"> 228404 </td>\n   <td style=\"text-align:right;\"> 484475 </td>\n   <td style=\"text-align:right;\"> 9.0046 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 57512 </td>\n   <td style=\"text-align:right;\"> 6460 </td>\n   <td style=\"text-align:right;\"> 2.42300 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.11232 </td>\n   <td style=\"text-align:right;\"> 0.43555 </td>\n   <td style=\"text-align:right;\"> 0.56445 </td>\n   <td style=\"text-align:right;\"> 37441 </td>\n   <td style=\"text-align:right;\"> 16307.457 </td>\n   <td style=\"text-align:right;\"> 145182 </td>\n   <td style=\"text-align:right;\"> 256070 </td>\n   <td style=\"text-align:right;\"> 6.8393 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 32248 </td>\n   <td style=\"text-align:right;\"> 6146 </td>\n   <td style=\"text-align:right;\"> 5.24699 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.19059 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 21134 </td>\n   <td style=\"text-align:right;\"> 21133.767 </td>\n   <td style=\"text-align:right;\"> 110889 </td>\n   <td style=\"text-align:right;\"> 110889 </td>\n   <td style=\"text-align:right;\"> 5.2470 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Construct a Cause-Deleted Life Table\n\n\n::: {#tbl-data-head .cell tbl-cap='Deaths for all causes and from neoplasms for U.S. females in 1991'}\n\n```{.r .cell-code  code-fold=\"true\"}\nurl = \"https://grodri.github.io/datasets/preston41.dat\"\nb41 <- read.table(url, header=FALSE)\nnames(b41) <- c(\"age\",\"D\",\"Di\",\"lx\",\"a\")\n\n# age = age\n# D = number of deaths\n# Di = number of neoplasm deaths\n# lx = number of individuals alive\n# a = {a}_n_{x} Nax is the average number of years lived in the x to x + n age interval by those dying \n#      in the interval. It is calculated as follows: Nax = 1/n * (Lx + Lx+1 + ... + Lx+n) where Lx \n#      is the number of people surviving to age x, and n is the interval of the age group.\n#      Nax is an important measure of mortality, as it indicates how many years people are expected \n#      to live after reaching a certain age.\n# qx = death rate at age x\n# mux = force of mortality at age x\n\ndf <- \n    b41 %>% \n    mutate(q = edit.na(1 - lead(lx) / lx, 1),   # this causes the last value to be one\n           \n           qi = q * Di / D, # The conditional probability of dying of a given cause given survival to the age group \n                            # is easy to obtain, we just multiply the overall probability by the ratio of deaths of \n                            # a given cause to all deaths\n           \n           d = lx * q,      # The unconditional counts of deaths of any cause and of a given cause are calculated\n                            # multiplying by the number surviving to the start of each age group, which is lx.\n                            # Recall that to die of cause i in the interval [x, x+n) one must survive all causes up to age x.\n           di = lx * qi) %>% \n    mutate( # Calculate survival function assuming constant hazard within age groups.\n        n = c(diff(age),NA), \n        m = edit.na(q / (n - q * (n - a)), 1 / tail(a,1)) # m[last] = 1/a[last]\n    ) %>% \n    mutate( # Compute cumulative hazard and survival \n        H = cumsum(n * m), \n        S = edit.na(exp(-lag(H)),1) # S[1]= 1\n    ) %>% \n    mutate(P = edit.na((S - lead(S))/m, tail(S/m,1)))\n\ndf %>% head(n=19) %>% \n    kable() %>% \n    kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> Di </th>\n   <th style=\"text-align:right;\"> lx </th>\n   <th style=\"text-align:right;\"> a </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> qi </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> di </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> m </th>\n   <th style=\"text-align:right;\"> H </th>\n   <th style=\"text-align:right;\"> S </th>\n   <th style=\"text-align:right;\"> P </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 15758 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 100000 </td>\n   <td style=\"text-align:right;\"> 0.152 </td>\n   <td style=\"text-align:right;\"> 0.00783 </td>\n   <td style=\"text-align:right;\"> 0.00003 </td>\n   <td style=\"text-align:right;\"> 783 </td>\n   <td style=\"text-align:right;\"> 3.1304 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.00788 </td>\n   <td style=\"text-align:right;\"> 0.00788 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.99607 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3169 </td>\n   <td style=\"text-align:right;\"> 275 </td>\n   <td style=\"text-align:right;\"> 99217 </td>\n   <td style=\"text-align:right;\"> 1.605 </td>\n   <td style=\"text-align:right;\"> 0.00168 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 14.4919 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.00042 </td>\n   <td style=\"text-align:right;\"> 0.00957 </td>\n   <td style=\"text-align:right;\"> 0.99215 </td>\n   <td style=\"text-align:right;\"> 3.96525 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1634 </td>\n   <td style=\"text-align:right;\"> 268 </td>\n   <td style=\"text-align:right;\"> 99050 </td>\n   <td style=\"text-align:right;\"> 2.275 </td>\n   <td style=\"text-align:right;\"> 0.00092 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 91 </td>\n   <td style=\"text-align:right;\"> 14.9253 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00018 </td>\n   <td style=\"text-align:right;\"> 0.01049 </td>\n   <td style=\"text-align:right;\"> 0.99048 </td>\n   <td style=\"text-align:right;\"> 4.95012 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1573 </td>\n   <td style=\"text-align:right;\"> 217 </td>\n   <td style=\"text-align:right;\"> 98959 </td>\n   <td style=\"text-align:right;\"> 2.843 </td>\n   <td style=\"text-align:right;\"> 0.00090 </td>\n   <td style=\"text-align:right;\"> 0.00012 </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 12.2778 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00018 </td>\n   <td style=\"text-align:right;\"> 0.01139 </td>\n   <td style=\"text-align:right;\"> 0.98957 </td>\n   <td style=\"text-align:right;\"> 4.94562 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 3955 </td>\n   <td style=\"text-align:right;\"> 318 </td>\n   <td style=\"text-align:right;\"> 98870 </td>\n   <td style=\"text-align:right;\"> 2.657 </td>\n   <td style=\"text-align:right;\"> 0.00236 </td>\n   <td style=\"text-align:right;\"> 0.00019 </td>\n   <td style=\"text-align:right;\"> 233 </td>\n   <td style=\"text-align:right;\"> 18.7343 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00047 </td>\n   <td style=\"text-align:right;\"> 0.01375 </td>\n   <td style=\"text-align:right;\"> 0.98868 </td>\n   <td style=\"text-align:right;\"> 4.93757 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 4948 </td>\n   <td style=\"text-align:right;\"> 467 </td>\n   <td style=\"text-align:right;\"> 98637 </td>\n   <td style=\"text-align:right;\"> 2.547 </td>\n   <td style=\"text-align:right;\"> 0.00262 </td>\n   <td style=\"text-align:right;\"> 0.00025 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 24.3504 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00052 </td>\n   <td style=\"text-align:right;\"> 0.01636 </td>\n   <td style=\"text-align:right;\"> 0.98635 </td>\n   <td style=\"text-align:right;\"> 4.92529 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 6491 </td>\n   <td style=\"text-align:right;\"> 856 </td>\n   <td style=\"text-align:right;\"> 98379 </td>\n   <td style=\"text-align:right;\"> 2.550 </td>\n   <td style=\"text-align:right;\"> 0.00314 </td>\n   <td style=\"text-align:right;\"> 0.00041 </td>\n   <td style=\"text-align:right;\"> 309 </td>\n   <td style=\"text-align:right;\"> 40.7493 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00063 </td>\n   <td style=\"text-align:right;\"> 0.01951 </td>\n   <td style=\"text-align:right;\"> 0.98377 </td>\n   <td style=\"text-align:right;\"> 4.91112 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 9428 </td>\n   <td style=\"text-align:right;\"> 1924 </td>\n   <td style=\"text-align:right;\"> 98070 </td>\n   <td style=\"text-align:right;\"> 2.616 </td>\n   <td style=\"text-align:right;\"> 0.00425 </td>\n   <td style=\"text-align:right;\"> 0.00087 </td>\n   <td style=\"text-align:right;\"> 417 </td>\n   <td style=\"text-align:right;\"> 85.0984 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00085 </td>\n   <td style=\"text-align:right;\"> 0.02377 </td>\n   <td style=\"text-align:right;\"> 0.98068 </td>\n   <td style=\"text-align:right;\"> 4.89296 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 12027 </td>\n   <td style=\"text-align:right;\"> 3532 </td>\n   <td style=\"text-align:right;\"> 97653 </td>\n   <td style=\"text-align:right;\"> 2.677 </td>\n   <td style=\"text-align:right;\"> 0.00584 </td>\n   <td style=\"text-align:right;\"> 0.00171 </td>\n   <td style=\"text-align:right;\"> 570 </td>\n   <td style=\"text-align:right;\"> 167.3934 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00117 </td>\n   <td style=\"text-align:right;\"> 0.02962 </td>\n   <td style=\"text-align:right;\"> 0.97651 </td>\n   <td style=\"text-align:right;\"> 4.86829 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 15543 </td>\n   <td style=\"text-align:right;\"> 5958 </td>\n   <td style=\"text-align:right;\"> 97083 </td>\n   <td style=\"text-align:right;\"> 2.685 </td>\n   <td style=\"text-align:right;\"> 0.00818 </td>\n   <td style=\"text-align:right;\"> 0.00314 </td>\n   <td style=\"text-align:right;\"> 794 </td>\n   <td style=\"text-align:right;\"> 304.3590 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00164 </td>\n   <td style=\"text-align:right;\"> 0.03783 </td>\n   <td style=\"text-align:right;\"> 0.97081 </td>\n   <td style=\"text-align:right;\"> 4.83418 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 19264 </td>\n   <td style=\"text-align:right;\"> 8434 </td>\n   <td style=\"text-align:right;\"> 96289 </td>\n   <td style=\"text-align:right;\"> 2.681 </td>\n   <td style=\"text-align:right;\"> 0.01330 </td>\n   <td style=\"text-align:right;\"> 0.00582 </td>\n   <td style=\"text-align:right;\"> 1281 </td>\n   <td style=\"text-align:right;\"> 560.8365 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00268 </td>\n   <td style=\"text-align:right;\"> 0.05122 </td>\n   <td style=\"text-align:right;\"> 0.96287 </td>\n   <td style=\"text-align:right;\"> 4.78229 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 25384 </td>\n   <td style=\"text-align:right;\"> 11673 </td>\n   <td style=\"text-align:right;\"> 95008 </td>\n   <td style=\"text-align:right;\"> 2.655 </td>\n   <td style=\"text-align:right;\"> 0.02095 </td>\n   <td style=\"text-align:right;\"> 0.00963 </td>\n   <td style=\"text-align:right;\"> 1990 </td>\n   <td style=\"text-align:right;\"> 915.1146 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00423 </td>\n   <td style=\"text-align:right;\"> 0.07237 </td>\n   <td style=\"text-align:right;\"> 0.95007 </td>\n   <td style=\"text-align:right;\"> 4.70046 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 37211 </td>\n   <td style=\"text-align:right;\"> 17078 </td>\n   <td style=\"text-align:right;\"> 93018 </td>\n   <td style=\"text-align:right;\"> 2.647 </td>\n   <td style=\"text-align:right;\"> 0.03371 </td>\n   <td style=\"text-align:right;\"> 0.01547 </td>\n   <td style=\"text-align:right;\"> 3136 </td>\n   <td style=\"text-align:right;\"> 1439.2682 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00685 </td>\n   <td style=\"text-align:right;\"> 0.10663 </td>\n   <td style=\"text-align:right;\"> 0.93018 </td>\n   <td style=\"text-align:right;\"> 4.57216 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 59431 </td>\n   <td style=\"text-align:right;\"> 25263 </td>\n   <td style=\"text-align:right;\"> 89882 </td>\n   <td style=\"text-align:right;\"> 2.646 </td>\n   <td style=\"text-align:right;\"> 0.05155 </td>\n   <td style=\"text-align:right;\"> 0.02191 </td>\n   <td style=\"text-align:right;\"> 4633 </td>\n   <td style=\"text-align:right;\"> 1969.4011 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01057 </td>\n   <td style=\"text-align:right;\"> 0.15946 </td>\n   <td style=\"text-align:right;\"> 0.89886 </td>\n   <td style=\"text-align:right;\"> 4.37764 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> 88087 </td>\n   <td style=\"text-align:right;\"> 33534 </td>\n   <td style=\"text-align:right;\"> 85249 </td>\n   <td style=\"text-align:right;\"> 2.631 </td>\n   <td style=\"text-align:right;\"> 0.07669 </td>\n   <td style=\"text-align:right;\"> 0.02920 </td>\n   <td style=\"text-align:right;\"> 6538 </td>\n   <td style=\"text-align:right;\"> 2488.9631 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01592 </td>\n   <td style=\"text-align:right;\"> 0.23904 </td>\n   <td style=\"text-align:right;\"> 0.85261 </td>\n   <td style=\"text-align:right;\"> 4.09781 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 114693 </td>\n   <td style=\"text-align:right;\"> 36695 </td>\n   <td style=\"text-align:right;\"> 78711 </td>\n   <td style=\"text-align:right;\"> 2.628 </td>\n   <td style=\"text-align:right;\"> 0.11552 </td>\n   <td style=\"text-align:right;\"> 0.03696 </td>\n   <td style=\"text-align:right;\"> 9093 </td>\n   <td style=\"text-align:right;\"> 2909.2241 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.02444 </td>\n   <td style=\"text-align:right;\"> 0.36126 </td>\n   <td style=\"text-align:right;\"> 0.78738 </td>\n   <td style=\"text-align:right;\"> 3.70583 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 143554 </td>\n   <td style=\"text-align:right;\"> 36571 </td>\n   <td style=\"text-align:right;\"> 69618 </td>\n   <td style=\"text-align:right;\"> 2.618 </td>\n   <td style=\"text-align:right;\"> 0.17427 </td>\n   <td style=\"text-align:right;\"> 0.04439 </td>\n   <td style=\"text-align:right;\"> 12132 </td>\n   <td style=\"text-align:right;\"> 3090.6793 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.03801 </td>\n   <td style=\"text-align:right;\"> 0.55131 </td>\n   <td style=\"text-align:right;\"> 0.69679 </td>\n   <td style=\"text-align:right;\"> 3.17293 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 164986 </td>\n   <td style=\"text-align:right;\"> 30220 </td>\n   <td style=\"text-align:right;\"> 57486 </td>\n   <td style=\"text-align:right;\"> 2.570 </td>\n   <td style=\"text-align:right;\"> 0.27363 </td>\n   <td style=\"text-align:right;\"> 0.05012 </td>\n   <td style=\"text-align:right;\"> 15730 </td>\n   <td style=\"text-align:right;\"> 2881.2178 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.06312 </td>\n   <td style=\"text-align:right;\"> 0.86691 </td>\n   <td style=\"text-align:right;\"> 0.57620 </td>\n   <td style=\"text-align:right;\"> 2.47064 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 320578 </td>\n   <td style=\"text-align:right;\"> 32739 </td>\n   <td style=\"text-align:right;\"> 41756 </td>\n   <td style=\"text-align:right;\"> 6.539 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.10212 </td>\n   <td style=\"text-align:right;\"> 41756 </td>\n   <td style=\"text-align:right;\"> 4264.3278 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.15293 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.42025 </td>\n   <td style=\"text-align:right;\"> 2.74800 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nWe obtain ``21205`` deaths due to neoplasms and a life-expectancy of ``78.85`` years.\n\n## Cause-Deleted Life Tables: Approach 1\n\nWhat would things look like if deaths due to neoplasms could be avoided?\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Calculate life expectancy without deaths due to neoplasms.\"}\ndf_ <- \n    df %>% \n    mutate(Rd = (D - Di) / D, \n           md = m * Rd) %>% \n    mutate( # now construct a survival function, but treating \n            # the hazard md as if its the only one operating\n        Hd = cumsum(n * md), \n        Sd = edit.na(exp(-lag(Hd)),1)\n    ) %>% \n    mutate(Pd = edit.na((Sd - lead(Sd))/md, tail(Sd/md,1)))\n```\n:::\n\n\nThis changes life-expectancy to ``82.39`` years. Note that this is under a (strong) assumption of independence among the competing causes. \n\n## Cause-Deleted Life Tables: Approach 2\n\nThis is based on Chiang's method. This method assumps proportionality of cause-specific hazards within an age group (which as the textbook notes, is weaker than the constant risk assumption used above). \n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Calculate life expectancy without deaths due to neoplasms.\"}\ndf2_ <-\n    df_ %>%\n    mutate(pd = (1 - q) ^ Rd,\n           ld = 100000 * cumprod(c(1, pd[-length(pd)]))) %>%\n    mutate(\n        dd = edit.na(ld - lead(ld), tail(ld, 1)),\n        qd = dd / ld,\n        ad = ifelse(\n            age < 10 | age == 80,\n            n + Rd * (q / qd) * (a - n),\n            ifelse(age >= 10 & age <= 75,\n                   ((-5 / 24) * lag(dd) + 2.5 * dd + (5 / 24) * lead(dd)) / dd,\n                   a / Rd)\n        )\n    ) %>% \n    mutate(\n        Ld = edit.na(dd * ad + (ld - dd) * n,  tail(ld * ad, 1))\n    )\n```\n:::\n\n\n\nThis method yields a life expectancy of ``82.46`` years. \n\n## Final Cause-Deleted Life Table\n\n\n::: {#tbl-final .cell tbl-cap='Cause-Deleted Life Table After Removing Deaths From Neoplasms (1991 US Females)'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Create Final Cause-Deleted Life Table.\"}\nlt <-\n    df2_ %>%\n    mutate(\n        Td = sum(Ld) - cumsum(Ld) + Ld, \n        ed = Td / ld\n    ) #%>% \n    #select(age,Rd,lx,a,ld,ad,ed)\n\nlt %>% head(n=19) %>% \n    kable() %>% \n    kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> Di </th>\n   <th style=\"text-align:right;\"> lx </th>\n   <th style=\"text-align:right;\"> a </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> qi </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> di </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> m </th>\n   <th style=\"text-align:right;\"> H </th>\n   <th style=\"text-align:right;\"> S </th>\n   <th style=\"text-align:right;\"> P </th>\n   <th style=\"text-align:right;\"> Rd </th>\n   <th style=\"text-align:right;\"> md </th>\n   <th style=\"text-align:right;\"> Hd </th>\n   <th style=\"text-align:right;\"> Sd </th>\n   <th style=\"text-align:right;\"> Pd </th>\n   <th style=\"text-align:right;\"> pd </th>\n   <th style=\"text-align:right;\"> ld </th>\n   <th style=\"text-align:right;\"> dd </th>\n   <th style=\"text-align:right;\"> qd </th>\n   <th style=\"text-align:right;\"> ad </th>\n   <th style=\"text-align:right;\"> Ld </th>\n   <th style=\"text-align:right;\"> Td </th>\n   <th style=\"text-align:right;\"> ed </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 15758 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 100000 </td>\n   <td style=\"text-align:right;\"> 0.152 </td>\n   <td style=\"text-align:right;\"> 0.00783 </td>\n   <td style=\"text-align:right;\"> 0.00003 </td>\n   <td style=\"text-align:right;\"> 783 </td>\n   <td style=\"text-align:right;\"> 3.1304 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.00788 </td>\n   <td style=\"text-align:right;\"> 0.00788 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.99607 </td>\n   <td style=\"text-align:right;\"> 0.99600 </td>\n   <td style=\"text-align:right;\"> 0.00785 </td>\n   <td style=\"text-align:right;\"> 0.00785 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.99608 </td>\n   <td style=\"text-align:right;\"> 0.99220 </td>\n   <td style=\"text-align:right;\"> 100000 </td>\n   <td style=\"text-align:right;\"> 779.882 </td>\n   <td style=\"text-align:right;\"> 0.00780 </td>\n   <td style=\"text-align:right;\"> 0.15201 </td>\n   <td style=\"text-align:right;\"> 99339 </td>\n   <td style=\"text-align:right;\"> 8245748 </td>\n   <td style=\"text-align:right;\"> 82.4575 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3169 </td>\n   <td style=\"text-align:right;\"> 275 </td>\n   <td style=\"text-align:right;\"> 99217 </td>\n   <td style=\"text-align:right;\"> 1.605 </td>\n   <td style=\"text-align:right;\"> 0.00168 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 167 </td>\n   <td style=\"text-align:right;\"> 14.4919 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0.00042 </td>\n   <td style=\"text-align:right;\"> 0.00957 </td>\n   <td style=\"text-align:right;\"> 0.99215 </td>\n   <td style=\"text-align:right;\"> 3.96525 </td>\n   <td style=\"text-align:right;\"> 0.91322 </td>\n   <td style=\"text-align:right;\"> 0.00038 </td>\n   <td style=\"text-align:right;\"> 0.00939 </td>\n   <td style=\"text-align:right;\"> 0.99218 </td>\n   <td style=\"text-align:right;\"> 3.96567 </td>\n   <td style=\"text-align:right;\"> 0.99846 </td>\n   <td style=\"text-align:right;\"> 99220 </td>\n   <td style=\"text-align:right;\"> 152.524 </td>\n   <td style=\"text-align:right;\"> 0.00154 </td>\n   <td style=\"text-align:right;\"> 1.60518 </td>\n   <td style=\"text-align:right;\"> 396515 </td>\n   <td style=\"text-align:right;\"> 8146410 </td>\n   <td style=\"text-align:right;\"> 82.1044 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1634 </td>\n   <td style=\"text-align:right;\"> 268 </td>\n   <td style=\"text-align:right;\"> 99050 </td>\n   <td style=\"text-align:right;\"> 2.275 </td>\n   <td style=\"text-align:right;\"> 0.00092 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 91 </td>\n   <td style=\"text-align:right;\"> 14.9253 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00018 </td>\n   <td style=\"text-align:right;\"> 0.01049 </td>\n   <td style=\"text-align:right;\"> 0.99048 </td>\n   <td style=\"text-align:right;\"> 4.95012 </td>\n   <td style=\"text-align:right;\"> 0.83599 </td>\n   <td style=\"text-align:right;\"> 0.00015 </td>\n   <td style=\"text-align:right;\"> 0.01016 </td>\n   <td style=\"text-align:right;\"> 0.99065 </td>\n   <td style=\"text-align:right;\"> 4.95137 </td>\n   <td style=\"text-align:right;\"> 0.99923 </td>\n   <td style=\"text-align:right;\"> 99068 </td>\n   <td style=\"text-align:right;\"> 76.094 </td>\n   <td style=\"text-align:right;\"> 0.00077 </td>\n   <td style=\"text-align:right;\"> 2.27521 </td>\n   <td style=\"text-align:right;\"> 495131 </td>\n   <td style=\"text-align:right;\"> 7749894 </td>\n   <td style=\"text-align:right;\"> 78.2284 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 1573 </td>\n   <td style=\"text-align:right;\"> 217 </td>\n   <td style=\"text-align:right;\"> 98959 </td>\n   <td style=\"text-align:right;\"> 2.843 </td>\n   <td style=\"text-align:right;\"> 0.00090 </td>\n   <td style=\"text-align:right;\"> 0.00012 </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 12.2778 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00018 </td>\n   <td style=\"text-align:right;\"> 0.01139 </td>\n   <td style=\"text-align:right;\"> 0.98957 </td>\n   <td style=\"text-align:right;\"> 4.94562 </td>\n   <td style=\"text-align:right;\"> 0.86205 </td>\n   <td style=\"text-align:right;\"> 0.00016 </td>\n   <td style=\"text-align:right;\"> 0.01093 </td>\n   <td style=\"text-align:right;\"> 0.98989 </td>\n   <td style=\"text-align:right;\"> 4.94755 </td>\n   <td style=\"text-align:right;\"> 0.99922 </td>\n   <td style=\"text-align:right;\"> 98992 </td>\n   <td style=\"text-align:right;\"> 76.752 </td>\n   <td style=\"text-align:right;\"> 0.00078 </td>\n   <td style=\"text-align:right;\"> 2.87537 </td>\n   <td style=\"text-align:right;\"> 494794 </td>\n   <td style=\"text-align:right;\"> 7254764 </td>\n   <td style=\"text-align:right;\"> 73.2867 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 3955 </td>\n   <td style=\"text-align:right;\"> 318 </td>\n   <td style=\"text-align:right;\"> 98870 </td>\n   <td style=\"text-align:right;\"> 2.657 </td>\n   <td style=\"text-align:right;\"> 0.00236 </td>\n   <td style=\"text-align:right;\"> 0.00019 </td>\n   <td style=\"text-align:right;\"> 233 </td>\n   <td style=\"text-align:right;\"> 18.7343 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00047 </td>\n   <td style=\"text-align:right;\"> 0.01375 </td>\n   <td style=\"text-align:right;\"> 0.98868 </td>\n   <td style=\"text-align:right;\"> 4.93757 </td>\n   <td style=\"text-align:right;\"> 0.91960 </td>\n   <td style=\"text-align:right;\"> 0.00043 </td>\n   <td style=\"text-align:right;\"> 0.01310 </td>\n   <td style=\"text-align:right;\"> 0.98913 </td>\n   <td style=\"text-align:right;\"> 4.94027 </td>\n   <td style=\"text-align:right;\"> 0.99783 </td>\n   <td style=\"text-align:right;\"> 98915 </td>\n   <td style=\"text-align:right;\"> 214.383 </td>\n   <td style=\"text-align:right;\"> 0.00217 </td>\n   <td style=\"text-align:right;\"> 2.65264 </td>\n   <td style=\"text-align:right;\"> 494071 </td>\n   <td style=\"text-align:right;\"> 6759969 </td>\n   <td style=\"text-align:right;\"> 68.3414 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 4948 </td>\n   <td style=\"text-align:right;\"> 467 </td>\n   <td style=\"text-align:right;\"> 98637 </td>\n   <td style=\"text-align:right;\"> 2.547 </td>\n   <td style=\"text-align:right;\"> 0.00262 </td>\n   <td style=\"text-align:right;\"> 0.00025 </td>\n   <td style=\"text-align:right;\"> 258 </td>\n   <td style=\"text-align:right;\"> 24.3504 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00052 </td>\n   <td style=\"text-align:right;\"> 0.01636 </td>\n   <td style=\"text-align:right;\"> 0.98635 </td>\n   <td style=\"text-align:right;\"> 4.92529 </td>\n   <td style=\"text-align:right;\"> 0.90562 </td>\n   <td style=\"text-align:right;\"> 0.00047 </td>\n   <td style=\"text-align:right;\"> 0.01547 </td>\n   <td style=\"text-align:right;\"> 0.98698 </td>\n   <td style=\"text-align:right;\"> 4.92906 </td>\n   <td style=\"text-align:right;\"> 0.99763 </td>\n   <td style=\"text-align:right;\"> 98700 </td>\n   <td style=\"text-align:right;\"> 233.829 </td>\n   <td style=\"text-align:right;\"> 0.00237 </td>\n   <td style=\"text-align:right;\"> 2.54826 </td>\n   <td style=\"text-align:right;\"> 492929 </td>\n   <td style=\"text-align:right;\"> 6265899 </td>\n   <td style=\"text-align:right;\"> 63.4841 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 6491 </td>\n   <td style=\"text-align:right;\"> 856 </td>\n   <td style=\"text-align:right;\"> 98379 </td>\n   <td style=\"text-align:right;\"> 2.550 </td>\n   <td style=\"text-align:right;\"> 0.00314 </td>\n   <td style=\"text-align:right;\"> 0.00041 </td>\n   <td style=\"text-align:right;\"> 309 </td>\n   <td style=\"text-align:right;\"> 40.7493 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00063 </td>\n   <td style=\"text-align:right;\"> 0.01951 </td>\n   <td style=\"text-align:right;\"> 0.98377 </td>\n   <td style=\"text-align:right;\"> 4.91112 </td>\n   <td style=\"text-align:right;\"> 0.86813 </td>\n   <td style=\"text-align:right;\"> 0.00055 </td>\n   <td style=\"text-align:right;\"> 0.01821 </td>\n   <td style=\"text-align:right;\"> 0.98464 </td>\n   <td style=\"text-align:right;\"> 4.91650 </td>\n   <td style=\"text-align:right;\"> 0.99727 </td>\n   <td style=\"text-align:right;\"> 98467 </td>\n   <td style=\"text-align:right;\"> 268.545 </td>\n   <td style=\"text-align:right;\"> 0.00273 </td>\n   <td style=\"text-align:right;\"> 2.57653 </td>\n   <td style=\"text-align:right;\"> 491682 </td>\n   <td style=\"text-align:right;\"> 5772970 </td>\n   <td style=\"text-align:right;\"> 58.6287 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 9428 </td>\n   <td style=\"text-align:right;\"> 1924 </td>\n   <td style=\"text-align:right;\"> 98070 </td>\n   <td style=\"text-align:right;\"> 2.616 </td>\n   <td style=\"text-align:right;\"> 0.00425 </td>\n   <td style=\"text-align:right;\"> 0.00087 </td>\n   <td style=\"text-align:right;\"> 417 </td>\n   <td style=\"text-align:right;\"> 85.0984 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00085 </td>\n   <td style=\"text-align:right;\"> 0.02377 </td>\n   <td style=\"text-align:right;\"> 0.98068 </td>\n   <td style=\"text-align:right;\"> 4.89296 </td>\n   <td style=\"text-align:right;\"> 0.79593 </td>\n   <td style=\"text-align:right;\"> 0.00068 </td>\n   <td style=\"text-align:right;\"> 0.02160 </td>\n   <td style=\"text-align:right;\"> 0.98196 </td>\n   <td style=\"text-align:right;\"> 4.90148 </td>\n   <td style=\"text-align:right;\"> 0.99661 </td>\n   <td style=\"text-align:right;\"> 98198 </td>\n   <td style=\"text-align:right;\"> 332.479 </td>\n   <td style=\"text-align:right;\"> 0.00339 </td>\n   <td style=\"text-align:right;\"> 2.58477 </td>\n   <td style=\"text-align:right;\"> 490187 </td>\n   <td style=\"text-align:right;\"> 5281288 </td>\n   <td style=\"text-align:right;\"> 53.7820 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 12027 </td>\n   <td style=\"text-align:right;\"> 3532 </td>\n   <td style=\"text-align:right;\"> 97653 </td>\n   <td style=\"text-align:right;\"> 2.677 </td>\n   <td style=\"text-align:right;\"> 0.00584 </td>\n   <td style=\"text-align:right;\"> 0.00171 </td>\n   <td style=\"text-align:right;\"> 570 </td>\n   <td style=\"text-align:right;\"> 167.3934 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00117 </td>\n   <td style=\"text-align:right;\"> 0.02962 </td>\n   <td style=\"text-align:right;\"> 0.97651 </td>\n   <td style=\"text-align:right;\"> 4.86829 </td>\n   <td style=\"text-align:right;\"> 0.70633 </td>\n   <td style=\"text-align:right;\"> 0.00083 </td>\n   <td style=\"text-align:right;\"> 0.02573 </td>\n   <td style=\"text-align:right;\"> 0.97863 </td>\n   <td style=\"text-align:right;\"> 4.88307 </td>\n   <td style=\"text-align:right;\"> 0.99587 </td>\n   <td style=\"text-align:right;\"> 97866 </td>\n   <td style=\"text-align:right;\"> 403.829 </td>\n   <td style=\"text-align:right;\"> 0.00413 </td>\n   <td style=\"text-align:right;\"> 2.58246 </td>\n   <td style=\"text-align:right;\"> 488351 </td>\n   <td style=\"text-align:right;\"> 4791101 </td>\n   <td style=\"text-align:right;\"> 48.9560 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 15543 </td>\n   <td style=\"text-align:right;\"> 5958 </td>\n   <td style=\"text-align:right;\"> 97083 </td>\n   <td style=\"text-align:right;\"> 2.685 </td>\n   <td style=\"text-align:right;\"> 0.00818 </td>\n   <td style=\"text-align:right;\"> 0.00314 </td>\n   <td style=\"text-align:right;\"> 794 </td>\n   <td style=\"text-align:right;\"> 304.3590 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00164 </td>\n   <td style=\"text-align:right;\"> 0.03783 </td>\n   <td style=\"text-align:right;\"> 0.97081 </td>\n   <td style=\"text-align:right;\"> 4.83418 </td>\n   <td style=\"text-align:right;\"> 0.61668 </td>\n   <td style=\"text-align:right;\"> 0.00101 </td>\n   <td style=\"text-align:right;\"> 0.03079 </td>\n   <td style=\"text-align:right;\"> 0.97460 </td>\n   <td style=\"text-align:right;\"> 4.86067 </td>\n   <td style=\"text-align:right;\"> 0.99495 </td>\n   <td style=\"text-align:right;\"> 97462 </td>\n   <td style=\"text-align:right;\"> 492.324 </td>\n   <td style=\"text-align:right;\"> 0.00505 </td>\n   <td style=\"text-align:right;\"> 2.63691 </td>\n   <td style=\"text-align:right;\"> 486145 </td>\n   <td style=\"text-align:right;\"> 4302750 </td>\n   <td style=\"text-align:right;\"> 44.1481 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 45 </td>\n   <td style=\"text-align:right;\"> 19264 </td>\n   <td style=\"text-align:right;\"> 8434 </td>\n   <td style=\"text-align:right;\"> 96289 </td>\n   <td style=\"text-align:right;\"> 2.681 </td>\n   <td style=\"text-align:right;\"> 0.01330 </td>\n   <td style=\"text-align:right;\"> 0.00582 </td>\n   <td style=\"text-align:right;\"> 1281 </td>\n   <td style=\"text-align:right;\"> 560.8365 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00268 </td>\n   <td style=\"text-align:right;\"> 0.05122 </td>\n   <td style=\"text-align:right;\"> 0.96287 </td>\n   <td style=\"text-align:right;\"> 4.78229 </td>\n   <td style=\"text-align:right;\"> 0.56219 </td>\n   <td style=\"text-align:right;\"> 0.00151 </td>\n   <td style=\"text-align:right;\"> 0.03832 </td>\n   <td style=\"text-align:right;\"> 0.96968 </td>\n   <td style=\"text-align:right;\"> 4.83018 </td>\n   <td style=\"text-align:right;\"> 0.99250 </td>\n   <td style=\"text-align:right;\"> 96969 </td>\n   <td style=\"text-align:right;\"> 727.378 </td>\n   <td style=\"text-align:right;\"> 0.00750 </td>\n   <td style=\"text-align:right;\"> 2.67237 </td>\n   <td style=\"text-align:right;\"> 483154 </td>\n   <td style=\"text-align:right;\"> 3816605 </td>\n   <td style=\"text-align:right;\"> 39.3589 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 25384 </td>\n   <td style=\"text-align:right;\"> 11673 </td>\n   <td style=\"text-align:right;\"> 95008 </td>\n   <td style=\"text-align:right;\"> 2.655 </td>\n   <td style=\"text-align:right;\"> 0.02095 </td>\n   <td style=\"text-align:right;\"> 0.00963 </td>\n   <td style=\"text-align:right;\"> 1990 </td>\n   <td style=\"text-align:right;\"> 915.1146 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00423 </td>\n   <td style=\"text-align:right;\"> 0.07237 </td>\n   <td style=\"text-align:right;\"> 0.95007 </td>\n   <td style=\"text-align:right;\"> 4.70046 </td>\n   <td style=\"text-align:right;\"> 0.54014 </td>\n   <td style=\"text-align:right;\"> 0.00229 </td>\n   <td style=\"text-align:right;\"> 0.04975 </td>\n   <td style=\"text-align:right;\"> 0.96241 </td>\n   <td style=\"text-align:right;\"> 4.78464 </td>\n   <td style=\"text-align:right;\"> 0.98863 </td>\n   <td style=\"text-align:right;\"> 96242 </td>\n   <td style=\"text-align:right;\"> 1094.144 </td>\n   <td style=\"text-align:right;\"> 0.01137 </td>\n   <td style=\"text-align:right;\"> 2.69457 </td>\n   <td style=\"text-align:right;\"> 478687 </td>\n   <td style=\"text-align:right;\"> 3333451 </td>\n   <td style=\"text-align:right;\"> 34.6362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 37211 </td>\n   <td style=\"text-align:right;\"> 17078 </td>\n   <td style=\"text-align:right;\"> 93018 </td>\n   <td style=\"text-align:right;\"> 2.647 </td>\n   <td style=\"text-align:right;\"> 0.03371 </td>\n   <td style=\"text-align:right;\"> 0.01547 </td>\n   <td style=\"text-align:right;\"> 3136 </td>\n   <td style=\"text-align:right;\"> 1439.2682 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.00685 </td>\n   <td style=\"text-align:right;\"> 0.10663 </td>\n   <td style=\"text-align:right;\"> 0.93018 </td>\n   <td style=\"text-align:right;\"> 4.57216 </td>\n   <td style=\"text-align:right;\"> 0.54105 </td>\n   <td style=\"text-align:right;\"> 0.00371 </td>\n   <td style=\"text-align:right;\"> 0.06828 </td>\n   <td style=\"text-align:right;\"> 0.95147 </td>\n   <td style=\"text-align:right;\"> 4.71354 </td>\n   <td style=\"text-align:right;\"> 0.98162 </td>\n   <td style=\"text-align:right;\"> 95148 </td>\n   <td style=\"text-align:right;\"> 1749.234 </td>\n   <td style=\"text-align:right;\"> 0.01838 </td>\n   <td style=\"text-align:right;\"> 2.70304 </td>\n   <td style=\"text-align:right;\"> 471721 </td>\n   <td style=\"text-align:right;\"> 2854764 </td>\n   <td style=\"text-align:right;\"> 30.0035 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 59431 </td>\n   <td style=\"text-align:right;\"> 25263 </td>\n   <td style=\"text-align:right;\"> 89882 </td>\n   <td style=\"text-align:right;\"> 2.646 </td>\n   <td style=\"text-align:right;\"> 0.05155 </td>\n   <td style=\"text-align:right;\"> 0.02191 </td>\n   <td style=\"text-align:right;\"> 4633 </td>\n   <td style=\"text-align:right;\"> 1969.4011 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01057 </td>\n   <td style=\"text-align:right;\"> 0.15946 </td>\n   <td style=\"text-align:right;\"> 0.89886 </td>\n   <td style=\"text-align:right;\"> 4.37764 </td>\n   <td style=\"text-align:right;\"> 0.57492 </td>\n   <td style=\"text-align:right;\"> 0.00607 </td>\n   <td style=\"text-align:right;\"> 0.09865 </td>\n   <td style=\"text-align:right;\"> 0.93400 </td>\n   <td style=\"text-align:right;\"> 4.59979 </td>\n   <td style=\"text-align:right;\"> 0.97003 </td>\n   <td style=\"text-align:right;\"> 93399 </td>\n   <td style=\"text-align:right;\"> 2798.900 </td>\n   <td style=\"text-align:right;\"> 0.02997 </td>\n   <td style=\"text-align:right;\"> 2.69495 </td>\n   <td style=\"text-align:right;\"> 460541 </td>\n   <td style=\"text-align:right;\"> 2383043 </td>\n   <td style=\"text-align:right;\"> 25.5148 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 65 </td>\n   <td style=\"text-align:right;\"> 88087 </td>\n   <td style=\"text-align:right;\"> 33534 </td>\n   <td style=\"text-align:right;\"> 85249 </td>\n   <td style=\"text-align:right;\"> 2.631 </td>\n   <td style=\"text-align:right;\"> 0.07669 </td>\n   <td style=\"text-align:right;\"> 0.02920 </td>\n   <td style=\"text-align:right;\"> 6538 </td>\n   <td style=\"text-align:right;\"> 2488.9631 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.01592 </td>\n   <td style=\"text-align:right;\"> 0.23904 </td>\n   <td style=\"text-align:right;\"> 0.85261 </td>\n   <td style=\"text-align:right;\"> 4.09781 </td>\n   <td style=\"text-align:right;\"> 0.61931 </td>\n   <td style=\"text-align:right;\"> 0.00986 </td>\n   <td style=\"text-align:right;\"> 0.14794 </td>\n   <td style=\"text-align:right;\"> 0.90606 </td>\n   <td style=\"text-align:right;\"> 4.42046 </td>\n   <td style=\"text-align:right;\"> 0.95178 </td>\n   <td style=\"text-align:right;\"> 90600 </td>\n   <td style=\"text-align:right;\"> 4368.320 </td>\n   <td style=\"text-align:right;\"> 0.04822 </td>\n   <td style=\"text-align:right;\"> 2.69590 </td>\n   <td style=\"text-align:right;\"> 442933 </td>\n   <td style=\"text-align:right;\"> 1922501 </td>\n   <td style=\"text-align:right;\"> 21.2197 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 114693 </td>\n   <td style=\"text-align:right;\"> 36695 </td>\n   <td style=\"text-align:right;\"> 78711 </td>\n   <td style=\"text-align:right;\"> 2.628 </td>\n   <td style=\"text-align:right;\"> 0.11552 </td>\n   <td style=\"text-align:right;\"> 0.03696 </td>\n   <td style=\"text-align:right;\"> 9093 </td>\n   <td style=\"text-align:right;\"> 2909.2241 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.02444 </td>\n   <td style=\"text-align:right;\"> 0.36126 </td>\n   <td style=\"text-align:right;\"> 0.78738 </td>\n   <td style=\"text-align:right;\"> 3.70583 </td>\n   <td style=\"text-align:right;\"> 0.68006 </td>\n   <td style=\"text-align:right;\"> 0.01662 </td>\n   <td style=\"text-align:right;\"> 0.23106 </td>\n   <td style=\"text-align:right;\"> 0.86248 </td>\n   <td style=\"text-align:right;\"> 4.13806 </td>\n   <td style=\"text-align:right;\"> 0.91991 </td>\n   <td style=\"text-align:right;\"> 86231 </td>\n   <td style=\"text-align:right;\"> 6906.623 </td>\n   <td style=\"text-align:right;\"> 0.08009 </td>\n   <td style=\"text-align:right;\"> 2.68644 </td>\n   <td style=\"text-align:right;\"> 415178 </td>\n   <td style=\"text-align:right;\"> 1479568 </td>\n   <td style=\"text-align:right;\"> 17.1581 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 75 </td>\n   <td style=\"text-align:right;\"> 143554 </td>\n   <td style=\"text-align:right;\"> 36571 </td>\n   <td style=\"text-align:right;\"> 69618 </td>\n   <td style=\"text-align:right;\"> 2.618 </td>\n   <td style=\"text-align:right;\"> 0.17427 </td>\n   <td style=\"text-align:right;\"> 0.04439 </td>\n   <td style=\"text-align:right;\"> 12132 </td>\n   <td style=\"text-align:right;\"> 3090.6793 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.03801 </td>\n   <td style=\"text-align:right;\"> 0.55131 </td>\n   <td style=\"text-align:right;\"> 0.69679 </td>\n   <td style=\"text-align:right;\"> 3.17293 </td>\n   <td style=\"text-align:right;\"> 0.74525 </td>\n   <td style=\"text-align:right;\"> 0.02833 </td>\n   <td style=\"text-align:right;\"> 0.37269 </td>\n   <td style=\"text-align:right;\"> 0.79369 </td>\n   <td style=\"text-align:right;\"> 3.70026 </td>\n   <td style=\"text-align:right;\"> 0.86701 </td>\n   <td style=\"text-align:right;\"> 79325 </td>\n   <td style=\"text-align:right;\"> 10549.135 </td>\n   <td style=\"text-align:right;\"> 0.13299 </td>\n   <td style=\"text-align:right;\"> 2.67576 </td>\n   <td style=\"text-align:right;\"> 372105 </td>\n   <td style=\"text-align:right;\"> 1064390 </td>\n   <td style=\"text-align:right;\"> 13.4181 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 80 </td>\n   <td style=\"text-align:right;\"> 164986 </td>\n   <td style=\"text-align:right;\"> 30220 </td>\n   <td style=\"text-align:right;\"> 57486 </td>\n   <td style=\"text-align:right;\"> 2.570 </td>\n   <td style=\"text-align:right;\"> 0.27363 </td>\n   <td style=\"text-align:right;\"> 0.05012 </td>\n   <td style=\"text-align:right;\"> 15730 </td>\n   <td style=\"text-align:right;\"> 2881.2178 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0.06312 </td>\n   <td style=\"text-align:right;\"> 0.86691 </td>\n   <td style=\"text-align:right;\"> 0.57620 </td>\n   <td style=\"text-align:right;\"> 2.47064 </td>\n   <td style=\"text-align:right;\"> 0.81683 </td>\n   <td style=\"text-align:right;\"> 0.05156 </td>\n   <td style=\"text-align:right;\"> 0.63048 </td>\n   <td style=\"text-align:right;\"> 0.68888 </td>\n   <td style=\"text-align:right;\"> 3.03625 </td>\n   <td style=\"text-align:right;\"> 0.77017 </td>\n   <td style=\"text-align:right;\"> 68776 </td>\n   <td style=\"text-align:right;\"> 15806.494 </td>\n   <td style=\"text-align:right;\"> 0.22983 </td>\n   <td style=\"text-align:right;\"> 2.63677 </td>\n   <td style=\"text-align:right;\"> 306524 </td>\n   <td style=\"text-align:right;\"> 692285 </td>\n   <td style=\"text-align:right;\"> 10.0658 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 320578 </td>\n   <td style=\"text-align:right;\"> 32739 </td>\n   <td style=\"text-align:right;\"> 41756 </td>\n   <td style=\"text-align:right;\"> 6.539 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 0.10212 </td>\n   <td style=\"text-align:right;\"> 41756 </td>\n   <td style=\"text-align:right;\"> 4264.3278 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.15293 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.42025 </td>\n   <td style=\"text-align:right;\"> 2.74800 </td>\n   <td style=\"text-align:right;\"> 0.89788 </td>\n   <td style=\"text-align:right;\"> 0.13731 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 0.53234 </td>\n   <td style=\"text-align:right;\"> 3.87687 </td>\n   <td style=\"text-align:right;\"> 0.00000 </td>\n   <td style=\"text-align:right;\"> 52969 </td>\n   <td style=\"text-align:right;\"> 52969.130 </td>\n   <td style=\"text-align:right;\"> 1.00000 </td>\n   <td style=\"text-align:right;\"> 7.28275 </td>\n   <td style=\"text-align:right;\"> 385761 </td>\n   <td style=\"text-align:right;\"> 385761 </td>\n   <td style=\"text-align:right;\"> 7.2828 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#https://github.com/scpatricio/bell_mortality/blob/main/script/functions.R\n# library(devtools)\n# install_github(\"robjhyndman/demography\")\n#install.packages(\"HMDHFDplus\")\n\nlibrary(demography)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: forecast\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'quantmod':\n  method            from\n  as.zoo.data.frame zoo \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 methods overwritten by 'demography':\n  method      from \n  print.lca   e1071\n  summary.lca e1071\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is demography 2.0.0.9000 \n```\n:::\n\n```{.r .cell-code}\nlibrary(fmsb)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'fmsb'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:demography':\n\n    lifetable\n```\n:::\n\n```{.r .cell-code}\n# hmd.usa <- hmd.mx(\"USA\",\"john.graves@vanderbilt.edu\", \"<PASSWORD>\",\"USA\")\n# write_rds(hmd.usa,file=here(\"blog/posts/cause-deleted-life-tables/data/usa-life-table.rds\"))\n\nhmd.usa <- read_rds(here(\"blog/posts/cause-deleted-life-tables/data/usa-life-table.rds\"))\n\nmin_age <- 18\n\nlt <- demography::lifetable(hmd.usa,series = \"male\", years = 2010)\ndf_lt <-   tibble(x = lt$age,qx = lt$qx[,\"2010\"]) %>% \n  filter(x >= min_age); df_lt\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 83  2\n       x       qx\n   <int>    <dbl>\n 1    18 0.000949\n 2    19 0.00103 \n 3    20 0.00111 \n 4    21 0.00127 \n 5    22 0.00126 \n 6    23 0.00128 \n 7    24 0.00136 \n 8    25 0.00131 \n 9    26 0.00136 \n10    27 0.00133 \n#  73 more rows\n```\n:::\n\n```{.r .cell-code}\nres <- fitGM(data = lt$qx)\nFLAG <- res[5]\nwhile (FLAG>0) {\n   res <- fitGM(res[1:3], lt$qx)\n   FLAG <- res[5]\n}\nprint(res)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.000019375 0.101511777 0.000869107 0.002996477 0.000000000\n```\n:::\n\n```{.r .cell-code}\nhatA <- res[1]\nhatB <- res[2]\nhatC <- res[3]\n\n# Makeham\n# Gamma-Imcompleta superior\n# Source: https://stats.stackexchange.com/questions/544081/gompertz-makeham-model-life-expectancy-using-numerical-integration-and-analytica\nGamma_Inc_sup = function(s, z){\n  integrate(function(t){\n    t^(s-1)*exp(-t)\n  }, z, Inf)$value\n}\n\nex_mak = function(t, a, b, c){\n  (exp(a*exp(b*t)/b)/b)*((a*exp(b*t)/b)^(c/b))*Gamma_Inc_sup(-c/b,a*exp(b*t)/b)\n}\n\nlife.expectancy(hmd.usa, years = 2010, age = 40,series = \"male\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime Series:\nStart = 2010 \nEnd = 2010 \nFrequency = 1 \n[1] 38.523\n```\n:::\n\n```{.r .cell-code}\nex_mak(40,hatA,hatB,hatC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 38.501\n```\n:::\n\n```{.r .cell-code}\nlife_exp <- \n  seq(40,90,1) %>% map_df(~{\n    res1 <- ex_mak(.x,hatA,hatB,hatC)\n    res2 <- life.expectancy(hmd.usa, years = 2010, age = .x,series = \"male\")\n    out <- data.frame(lt = res2[1], gm = res1)\n    out\n  })\n\n\nlife_exp %>% \n  ggplot(aes(x = lt, y = gm)) + geom_point() + \n  geom_abline(a=0,b=1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_abline(a = 0, b = 1): Ignoring unknown parameters: `a` and `b`\n```\n:::\n\n::: {.cell-output-display}\n![](cause-delented-life-tables_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "cause-delented-life-tables_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}