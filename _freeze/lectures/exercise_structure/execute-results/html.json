{
  "hash": "6caf2228f95a6787739845e95f8a1c5d",
  "result": {
    "markdown": "---\ntitle: \"Structuring the Markov Model: Group Exercise\"\nformat: revealjs\neditor: visual\n---\n\n\n\n## Model Diagram\n\n::: column-page\n\n\n```{dot}\n//| fig-width: 10\nstrict digraph {\n    H [label=\"Asympomatic (A)\"]\n    H -> H\n    H -> S\n    S [label=\"Progressive Disease (P)\"]\n    S -> S\n    H -> Db\n    Db [label=\"Death from other causes (Db)\"]\n    S -> Db\n    Db -> Db\n    S -> Dd\n    Dd [label=\"Death from disease (Dd)\"]\n    Dd -> Dd\n}\n```\n\n\n:::\n\n## Natural History Parameters\n\n-   Progressive disease incidence rate (`r_AP`): 0.4 over 10 years\n-   Background mortality rate (`r_Db`): 0.006 per year\n-   Hazard rate of death from progressive disease relative to background mortality (`HR_PDd`): 3.0\n\n## Strategy A: Preventive Measure\n\n-   Relative risk of developing progressive disease (`RR_AP`): 0.75\n\n## Strategy B: Disease Treatment\n\n-   Odds-ratio of death from progressive disease (`OR_PDd`): 0.80\n-   Baseline annual probability of death in underlying clinical trial (`p0_OR_PDd`): 0.03\n\n## Strategy C: Cure\n\n-   10-year disease remission rate (i.e., return to asymptomatic state; `r_PA_trtC`): 0.50\n\n## Parameter Table\n\n::: {style=\"font-size: 0.8em\"}\n| Parameter   | Description                                                                    | Value |\n|------------|-------------------------------------------------|------------|\n| `r_AP`      | 10-year progressive disease incidence rate                                     | 0.40  |\n| `r_Db`      | Background mortality rate                                                      | 0.006 |\n| `HR_PDd`    | Hazard rate of death from progressive disease relative to background mortality | 3.0   |\n| `RR_AP`     | Relative risk of developing progressive disease (**Strategy A**)               | 0.75  |\n| `OR_PDd`    | Odds-ratio of death from progressive disease (**Strategy B**)                  | 0.80  |\n| `p0_OR_PDd` | Baseline probability of death in underlying clinical trial (**Strategy B**)    | 0.03  |\n| `r_PA_trtC` | 10-year disease remission rate (**Strategy C**)                                | 0.50  |\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.1      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(Matrix)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n```{.r .cell-code}\nr_AP <- 0.40\nr_Db <- 0.006\nHR_PDd <- 3.0\nRR_AP <- 0.75\nOR_PDd <- 0.80\np0_OR_PDd <- 0.03\nr_PA_trtC <- 0.50\n\nm_R0 <- m_RA <- m_RB <- m_RC <-   \n  matrix(0, nrow=4, ncol = 4, dimnames=list(c(\"Asymptomatic\",\"Progressive Disease\",\"Disease Mortality\", \"Background Mortality\"),\n                                               c(\"Asymptomatic\",\"Progressive Disease\",\"Disease Mortality\", \"Background Mortality\")))\n\n# Step 1: Natural History  (i.e., m_R0 and m_P0)\n\nm_R0[\"Asymptomatic\",\"Asymptomatic\"] <- -(r_AP/10+r_Db)\nm_R0[\"Asymptomatic\",\"Progressive Disease\"] <- r_AP/10\nm_R0[\"Asymptomatic\",\"Background Mortality\"] <- r_Db\n\nm_R0[\"Progressive Disease\",\"Progressive Disease\"] <- -(HR_PDd * r_Db + r_Db)\nm_R0[\"Progressive Disease\",\"Disease Mortality\"] <- HR_PDd * r_Db\nm_R0[\"Progressive Disease\",\"Background Mortality\"] <- r_Db\n\nm_P0 <- expm(m_R0)\nm_P0[is.na(m_P0)] <- 0\n\n# Strategy A\n\nm_PA <- m_P0 \nm_PA[\"Asymptomatic\",\"Progressive Disease\"] <- RR_AP * m_P0[\"Asymptomatic\",\"Progressive Disease\"] \nm_PA[\"Asymptomatic\",\"Asymptomatic\"] <- 1 - m_PA[\"Asymptomatic\",\"Progressive Disease\"]  - m_PA[\"Asymptomatic\",\"Disease Mortality\"] - m_PA[\"Asymptomatic\",\"Background Mortality\"]\n\n# Strategy B\nm_PB <- m_P0 \nm_PB[\"Progressive Disease\",\"Disease Mortality\"] <- (OR_PDd / (1 - p0_OR_PDd + (p0_OR_PDd *OR_PDd  ))) * m_PB[\"Progressive Disease\",\"Disease Mortality\"]\nm_PB[\"Progressive Disease\",\"Progressive Disease\"] <- 1 - m_PB[\"Progressive Disease\",\"Asymptomatic\"] - m_PB[\"Progressive Disease\",\"Disease Mortality\"] - m_PB[\"Progressive Disease\",\"Background Mortality\"]\n\n# Strategy C\n\nm_RC <- m_R0 \nm_RC[\"Progressive Disease\",\"Asymptomatic\"]  <- (r_PA_trtC/10)\nm_RC[\"Progressive Disease\",\"Progressive Disease\"] <- -(m_RC[\"Progressive Disease\",\"Asymptomatic\"] + m_RC[\"Progressive Disease\",\"Disease Mortality\"] + m_RC[\"Progressive Disease\",\"Background Mortality\"])\nm_PC <- expm(m_RC)\n```\n:::\n\n\n\n## Key\n\n|                                                                   |\n|-------------------------------------------------------------------|\n| </span>[Rate adjusted for timestep]{style=\"background:#ff498c\"}   |\n| </span>[Hazard Ratio]{style=\"background:#fcb08a\"}                 |\n| </span>[Probability]{style=\"background:#ffc922\"}                  |\n| </span>[Relative Risk]{style=\"background:#cdea24\"}                |\n| </span>[Odds Ratio]{style=\"background:#9dd8da\"}                   |\n| </span>[Constructed from other cells]{style=\"background:#ab59cf\"} |\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor_lut <- \n  c(\"rate\" = \"#ff498c\",\n    \"hazard_ratio\" = \"#fcb08a\",\n    \"probability\" = \"#ffc922\",\n    \"relative_risk\" = \"#cdea24\", \n    \"odds_ratio\" = \"#9dd8da\", \n    \"constructed\" = \"#ab59cf\")\n```\n:::\n\n\n\n## Goal: Natural History Transition Probability Matrix\n\n**m_P0** =\n\n::: {style=\"font-size: 0.5em\"}\n|                      | Asymptomatic                                                         | Progressive Disease                                                  | Disease Mortality                                                    | Background Mortality                                                 |\n|---------------|---------------|---------------|---------------|---------------|\n| Asymptomatic         | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ab59cf\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} |\n| Progressive Disease  | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ab59cf\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} |\n| Disease Mortality    | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ab59cf\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} |\n| Background Mortality | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ffc922\"} | </span>[$\\quad \\quad \\quad \\quad \\quad$]{style=\"background:#ab59cf\"} |\n:::\n\n::: {style=\"font-size: 0.6em\"}\n|                                                                   |\n|-------------------------------------------------------------------|\n| </span>[Rate adjusted for timestep]{style=\"background:#ff498c\"}   |\n| </span>[Hazard Ratio]{style=\"background:#fcb08a\"}                 |\n| </span>[Probability]{style=\"background:#ffc922\"}                  |\n| </span>[Relative Risk]{style=\"background:#cdea24\"}                |\n| </span>[Odds Ratio]{style=\"background:#9dd8da\"}                   |\n| </span>[Constructed from other cells]{style=\"background:#ab59cf\"} |\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}