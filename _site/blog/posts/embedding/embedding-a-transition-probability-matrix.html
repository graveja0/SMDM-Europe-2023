<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SMDM Europe 2023: Health Economics Modeling Workshop - Embedding A Transition Probability Matrix for a Discrete Time Markov Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar floating slimcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      SMDM Europe 2023: Health Economics Modeling Workshop
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">SMDM Europe 2023: Health Economics Modeling Workshop</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What They Didnâ€™t Teach You About Decision Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../blog/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop Blog</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
 <span class="menu-text">lectures/lec_welcome.qmd</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">lectures/lec_structure.qmd</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/exercise_structure.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Group Exercise - Populating a Markov Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/exercise_ANS_structure.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Group Exercise Answer - Populating a Markov Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Case Studies</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Tools and Applications</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://mhorta.shinyapps.io/shinycea3/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workshop CEA Shiny Application</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://mhorta.shinyapps.io/gomp/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gompertz Mortality Parameters Fit to UN Life Table Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://dare.shinyapps.io/tree/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decision Tree Drawing Tool</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://mermaid.live/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mermaid Live Editor (Facilitates easy model diagram drawing)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="http://magjac.com/graphviz-visual-editor//" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphviz Visual Editor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.youtube.com/playlist?list=PLIT7NqYN7YT0TypPdKdN4qTomBp2aqt_C" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov Modeling in R (YouTube Video Series)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://darth-git.github.io/darthpack/articles/darthpack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov Modeling in R</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../roster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructors</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prologue" id="toc-prologue" class="nav-link active" data-scroll-target="#prologue">Prologue</a></li>
  <li><a href="#act-1-a-world-without-death" id="toc-act-1-a-world-without-death" class="nav-link" data-scroll-target="#act-1-a-world-without-death">Act 1: A World Without Death</a></li>
  <li><a href="#act-2-here-be-competing-risks-dragons" id="toc-act-2-here-be-competing-risks-dragons" class="nav-link" data-scroll-target="#act-2-here-be-competing-risks-dragons">Act 2: Here Be (Competing Risks) Dragons</a>
  <ul class="collapse">
  <li><a href="#standard-rate-to-transition-conversion" id="toc-standard-rate-to-transition-conversion" class="nav-link" data-scroll-target="#standard-rate-to-transition-conversion">Standard Rate-to-Transition Conversion</a>
  <ul class="collapse">
  <li><a href="#signs-of-trouble" id="toc-signs-of-trouble" class="nav-link" data-scroll-target="#signs-of-trouble">Signs of Trouble</a></li>
  <li><a href="#discretizing-a-continuous-time-process" id="toc-discretizing-a-continuous-time-process" class="nav-link" data-scroll-target="#discretizing-a-continuous-time-process">Discretizing a Continuous Time Process</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#act-iii-embedding-a-transition-matrix-and-recording-events" id="toc-act-iii-embedding-a-transition-matrix-and-recording-events" class="nav-link" data-scroll-target="#act-iii-embedding-a-transition-matrix-and-recording-events">Act III: Embedding a Transition Matrix and Recording Events</a>
  <ul class="collapse">
  <li><a href="#embed-the-transition-probability-matrix" id="toc-embed-the-transition-probability-matrix" class="nav-link" data-scroll-target="#embed-the-transition-probability-matrix">1. Embed the Transition Probability Matrix</a>
  <ul class="collapse">
  <li><a href="#why-is-this-important" id="toc-why-is-this-important" class="nav-link" data-scroll-target="#why-is-this-important">Why is this important?</a></li>
  </ul></li>
  <li><a href="#include-non-markovian-accumulators-to-record-event-transitions" id="toc-include-non-markovian-accumulators-to-record-event-transitions" class="nav-link" data-scroll-target="#include-non-markovian-accumulators-to-record-event-transitions">2. Include Non-Markovian Accumulators to Record Event Transitions</a></li>
  </ul></li>
  </ul>
</nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<p><img src="CHEMlogo_white.png" class="img-fluid"></p>
</div></div></div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Embedding A Transition Probability Matrix for a Discrete Time Markov Model</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="prologue" class="level1 page-columns page-full">
<h1>Prologue</h1>
<p>Define <span class="math inline">\(r_{HS}\)</span> and <span class="math inline">\(r_{HD}\)</span> as the hazard rate of two independent competing risks from a given (Healthy) health state (to Sick and Dead, respectively), and <span class="math inline">\(\Delta t\)</span> the cycle length (e.g., <span class="math inline">\(1\)</span>=1 year, <span class="math inline">\(1/12\)</span>=1 month, etc.). We can also define a third rate <span class="math inline">\(r_{SD} = hr_{S}*r_{HD}\)</span> for transitioning from sick to dead, i.e., the standard (healthy-to-dead) rate multiplied by the hazard ratio <span class="math inline">\(hr_{S}\)</span>.</p>
<p>The underlying Markov model takes the following form:</p>
<div class="column-page">
<div class="cell" data-fig-width="4" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div>
<svg width="384" height="480" viewbox="0.00 0.00 193.94 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 189.94,-184 189.94,4 -4,4"></polygon> <!-- Healthy --> <g id="node1" class="node">
<title>
Healthy
</title>
<ellipse fill="none" stroke="black" cx="41.61" cy="-90" rx="41.71" ry="18"></ellipse> <text text-anchor="middle" x="41.61" y="-85.8" font-family="Times,serif" font-size="14.00">Healthy</text> </g> <!-- Healthy&#45;&gt;Healthy --> <g id="edge1" class="edge">
<title>
Healthy-&gt;Healthy
</title>
<path fill="none" stroke="black" d="M80.3,-96.74C92.04,-96.57 101.21,-94.32 101.21,-90 101.21,-87.03 96.88,-85.04 90.35,-84.03"></path> <polygon fill="black" stroke="black" points="90.54,-80.53 80.3,-83.26 90.01,-87.51 90.54,-80.53"></polygon> </g> <!-- Sick --> <g id="node2" class="node">
<title>
Sick
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-162" rx="28.41" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-157.8" font-family="Times,serif" font-size="14.00">Sick</text> </g> <!-- Healthy&#45;&gt;Sick --> <g id="edge3" class="edge">
<title>
Healthy-&gt;Sick
</title>
<path fill="none" stroke="black" d="M58.31,-106.7C67.93,-116.33 80.17,-128.57 90.69,-139.09"></path> <polygon fill="black" stroke="black" points="88.44,-141.78 97.98,-146.38 93.39,-136.83 88.44,-141.78"></polygon> <text text-anchor="middle" x="59.72" y="-127.09" font-family="Times,serif" font-size="14.00">r_HS</text> </g> <!-- Dead --> <g id="node3" class="node">
<title>
Dead
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-18" rx="31.32" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-13.8" font-family="Times,serif" font-size="14.00">Dead</text> </g> <!-- Healthy&#45;&gt;Dead --> <g id="edge5" class="edge">
<title>
Healthy-&gt;Dead
</title>
<path fill="none" stroke="black" d="M58.31,-73.3C67.93,-63.67 80.17,-51.43 90.69,-40.91"></path> <polygon fill="black" stroke="black" points="93.39,-43.17 97.98,-33.62 88.44,-38.22 93.39,-43.17"></polygon> <text text-anchor="middle" x="58.56" y="-44.51" font-family="Times,serif" font-size="14.00">r_HD</text> </g> <!-- Sick&#45;&gt;Sick --> <g id="edge2" class="edge">
<title>
Sick-&gt;Sick
</title>
<path fill="none" stroke="black" d="M140.2,-168.71C150.86,-169.09 159.81,-166.85 159.81,-162 159.81,-158.82 155.96,-156.76 150.29,-155.83"></path> <polygon fill="black" stroke="black" points="150.37,-152.33 140.2,-155.29 150,-159.32 150.37,-152.33"></polygon> </g> <!-- Sick&#45;&gt;Dead --> <g id="edge4" class="edge">
<title>
Sick-&gt;Dead
</title>
<path fill="none" stroke="black" d="M113.61,-143.76C113.61,-119.2 113.61,-75.25 113.61,-46.35"></path> <polygon fill="black" stroke="black" points="117.11,-46.09 113.61,-36.09 110.11,-46.09 117.11,-46.09"></polygon> <text text-anchor="middle" x="149.77" y="-99.26" font-family="Times,serif" font-size="14.00">hr_S * r_HD</text> </g> <!-- Dead&#45;&gt;Dead --> <g id="edge6" class="edge">
<title>
Dead-&gt;Dead
</title>
<path fill="none" stroke="black" d="M143.03,-24.74C153.99,-24.96 163.02,-22.71 163.02,-18 163.02,-14.91 159.13,-12.88 153.36,-11.91"></path> <polygon fill="black" stroke="black" points="153.23,-8.4 143.03,-11.26 152.79,-15.38 153.23,-8.4"></polygon> </g> </g>
</svg>
</div>
<figcaption class="figure-caption">Figure&nbsp;1: Model Diagram</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expm)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(directlabels)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Better accuracy that "life-table" aka trapezoidal method</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>alt_simp_coef <span class="ot">&lt;-</span> <span class="cf">function</span>(i) <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">59</span>, <span class="dv">43</span>, <span class="dv">49</span>, <span class="fu">rep</span>(<span class="dv">48</span>, i<span class="dv">-8</span>), <span class="dv">49</span>, <span class="dv">43</span>, <span class="dv">59</span>, <span class="dv">17</span>) <span class="sc">/</span> <span class="dv">48</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>alt_simp      <span class="ot">&lt;-</span> <span class="cf">function</span>(x,h) h<span class="sc">*</span><span class="fu">sum</span>(<span class="fu">alt_simp_coef</span>(<span class="fu">length</span>(x)) <span class="sc">*</span> x)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>r_HS <span class="ot">&lt;-</span> <span class="fl">0.15</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>r_HD <span class="ot">&lt;-</span> .<span class="dv">006</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>hr_S <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>r_SD <span class="ot">&lt;-</span> hr_S<span class="sc">*</span>r_HD</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>cycle <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-exp(-r_HS*cycle)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-exp(-r_HD*cycle)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>get_P <span class="ot">&lt;-</span> <span class="cf">function</span>(r_HS,r_HD,r_SD,cycle) {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  P_st <span class="ot">&lt;-</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>r_HS<span class="sc">*</span>cycle) <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>r_HD<span class="sc">*</span>cycle) <span class="sc">-</span><span class="dv">1</span> ,  (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r_HS<span class="sc">*</span>cycle)) ,  <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r_HD<span class="sc">*</span>cycle), </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="fu">exp</span>(<span class="sc">-</span>r_SD<span class="sc">*</span>cycle), <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r_SD<span class="sc">*</span>cycle),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>), <span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="st">"P_st"</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  P_eQ <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span>(r_HS<span class="sc">*</span>cycle<span class="sc">+</span>r_HD<span class="sc">*</span>cycle),r_HS<span class="sc">*</span>cycle,r_HD<span class="sc">*</span>cycle,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="sc">-</span>r_SD<span class="sc">*</span>cycle,r_SD<span class="sc">*</span>cycle,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow=</span><span class="dv">3</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span><span class="dv">3</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>), <span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">expm</span>() <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="st">"P_eQ"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  P_cr <span class="ot">&lt;-</span> </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>(r_HS<span class="sc">+</span>r_HD)<span class="sc">*</span>cycle) , (r_HS<span class="sc">/</span>(r_HS<span class="sc">+</span>r_HD)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>(r_HS<span class="sc">+</span>r_HD)<span class="sc">*</span>cycle))   ,(r_HD<span class="sc">/</span>(r_HS<span class="sc">+</span>r_HD)) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>(r_HS<span class="sc">+</span>r_HD)<span class="sc">*</span>cycle))   , </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="fu">exp</span>(<span class="sc">-</span>r_SD<span class="sc">*</span>cycle), <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r_SD<span class="sc">*</span>cycle),</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>, </span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>), <span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">name =</span> <span class="st">"P_cr"</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>( P_st, P_cr , P_eQ)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>check_sens <span class="ot">&lt;-</span> <span class="cf">function</span>(r_HD,r_HS,r_SD,cycle) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span>(r_HS<span class="sc">*</span>cycle<span class="sc">+</span>r_HD<span class="sc">*</span>cycle),r_HS<span class="sc">*</span>cycle,r_HD<span class="sc">*</span>cycle,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="sc">-</span>r_SD<span class="sc">*</span>cycle,r_SD<span class="sc">*</span>cycle,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow=</span><span class="dv">3</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span><span class="dv">3</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>), <span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Q_ &lt;- rbind(cbind(Q,c(r_HS*cycle,0,0)),c(0,0,0,0)) </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Q_ &lt;- rbind(cbind(Q_,c(r_HD*cycle,0,0,0)),c(0,0,0,0,0))</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># dimnames(Q_) = list(c("Healthy","Sick","Dead","accS","accHD"),</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                    c("Healthy","Sick","Dead","accS","accHD"))</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Q_ <span class="ot">&lt;-</span> Q</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> Q_ <span class="sc">%&gt;%</span> <span class="fu">expm</span>() <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>() </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">get_P</span>(<span class="at">r_HS=</span>r_HS,<span class="at">r_HD=</span>r_HD,<span class="at">r_SD=</span>r_SD,<span class="at">cycle=</span>cycle)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>P_cr <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"P_cr"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(from,Healthy,Sick,Dead) <span class="sc">%&gt;%</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>P_st <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"P_st"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(from,Healthy,Sick,Dead) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>le1 <span class="ot">&lt;-</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%^%</span> (.x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>(.x <span class="sc">%&gt;%</span> data.frame)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  {.[,<span class="sc">-</span><span class="dv">3</span>]} <span class="sc">%&gt;%</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alt_simp</span>(.,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  {. <span class="sc">*</span> cycle} <span class="sc">%&gt;%</span> {.<span class="sc">/</span><span class="dv">1000</span>} <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">"life_exp"</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P <span class="sc">%^%</span>.x) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(le1) <span class="sc">%&gt;%</span> </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"P_eQ"</span>) </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>le2 <span class="ot">&lt;-</span> </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P_cr[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%^%</span> (.x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>(.x <span class="sc">%&gt;%</span> data.frame)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  {.[,<span class="sc">-</span><span class="dv">3</span>]} <span class="sc">%&gt;%</span> </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alt_simp</span>(.,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  {. <span class="sc">*</span> cycle} <span class="sc">%&gt;%</span> {.<span class="sc">/</span><span class="dv">1000</span>} <span class="sc">%&gt;%</span> </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">"life_exp"</span>)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P_cr <span class="sc">%^%</span>.x) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(le2) <span class="sc">%&gt;%</span> </span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"P_cr"</span>)</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>le3 <span class="ot">&lt;-</span> </span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P_st[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%^%</span> (.x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>(.x <span class="sc">%&gt;%</span> data.frame)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>  {.[,<span class="sc">-</span><span class="dv">3</span>]} <span class="sc">%&gt;%</span> </span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alt_simp</span>(.,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  {. <span class="sc">*</span> cycle} <span class="sc">%&gt;%</span> {.<span class="sc">/</span><span class="dv">1000</span>} <span class="sc">%&gt;%</span> </span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">"life_exp"</span>)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P_st <span class="sc">%^%</span>.x) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle =</span> <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">/</span>cycle)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(le3) <span class="sc">%&gt;%</span> </span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="st">"P_st"</span>)</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> res1 <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(res2) <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(res3)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="act-1-a-world-without-death" class="level1">
<h1>Act 1: A World Without Death</h1>
<p>Itâ€™s useful to begin with a completely unrealistic scenario: there is essentially no death. That is, individuals can either be Healthy or Sick, but they do not die. Furthermore, as shown in <a href="#fig-model">Figure&nbsp;1</a>, once someone becomes sick, they are chronically ill and can not transition back to death.</p>
<p>Letâ€™s set the model parameters as follows. Essentially what weâ€™re doing is setting the death rate(<code>r_HD)</code> to an extraordinarily small number (<code>0.00000001)</code></p>
<table class="table">
<thead>
<tr class="header">
<th>param</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>r_HS</td>
<td>0.15</td>
</tr>
<tr class="even">
<td>r_HD</td>
<td>10^{-8}</td>
</tr>
<tr class="odd">
<td>hr_S</td>
<td>10</td>
</tr>
<tr class="even">
<td>r_SD</td>
<td>10^{-7}</td>
</tr>
</tbody>
</table>
<p>It is common to use the following formula to convert rates to probabilities:</p>
<p><span class="math display">\[
p_{HS}= 1 - e^{-r_{HS}\Delta t}
\]</span></p>
<p>Applying this to our example, the probability of transitioning from healthy to sick in a single one-year cycle is</p>
<p><span class="math display">\[
p_{HD} = 1 - e^{-0.15} = 0.139292
\]</span></p>
<p>After 2 years (1-year cycle), and assuming there is essentially no death at all in a starting cohort of 1,000 individuals, how many people would we expect to be in the sick state?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>) <span class="sc">%*%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span>),<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span>),<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>),<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>))) <span class="sc">%^%</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-nodeath1y" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="alwcwimtsg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#alwcwimtsg .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#alwcwimtsg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alwcwimtsg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#alwcwimtsg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#alwcwimtsg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#alwcwimtsg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alwcwimtsg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#alwcwimtsg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#alwcwimtsg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#alwcwimtsg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#alwcwimtsg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#alwcwimtsg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#alwcwimtsg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#alwcwimtsg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#alwcwimtsg .gt_from_md > :first-child {
  margin-top: 0;
}

#alwcwimtsg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#alwcwimtsg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#alwcwimtsg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#alwcwimtsg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#alwcwimtsg .gt_row_group_first td {
  border-top-width: 2px;
}

#alwcwimtsg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alwcwimtsg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#alwcwimtsg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#alwcwimtsg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alwcwimtsg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#alwcwimtsg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#alwcwimtsg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#alwcwimtsg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#alwcwimtsg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alwcwimtsg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alwcwimtsg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#alwcwimtsg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#alwcwimtsg .gt_left {
  text-align: left;
}

#alwcwimtsg .gt_center {
  text-align: center;
}

#alwcwimtsg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#alwcwimtsg .gt_font_normal {
  font-weight: normal;
}

#alwcwimtsg .gt_font_bold {
  font-weight: bold;
}

#alwcwimtsg .gt_font_italic {
  font-style: italic;
}

#alwcwimtsg .gt_super {
  font-size: 65%;
}

#alwcwimtsg .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#alwcwimtsg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#alwcwimtsg .gt_indent_1 {
  text-indent: 5px;
}

#alwcwimtsg .gt_indent_2 {
  text-indent: 10px;
}

#alwcwimtsg .gt_indent_3 {
  text-indent: 15px;
}

#alwcwimtsg .gt_indent_4 {
  text-indent: 20px;
}

#alwcwimtsg .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Healthy">740.8182</td>
<td class="gt_row gt_right" headers="Sick">259.1818</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;2: State Occpancy with No Death</figcaption>
</figure>
</div>
</div>
<p>Letâ€™s also calculate total life expectancy to make sure everything is running smoothly. Weâ€™ll also ignore any discounting in the life expectancy calculation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span><span class="dv">60</span> <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>({</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>) <span class="sc">%*%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span>),<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span>),<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>),<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>))) <span class="sc">%^%</span> .x) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  }))  <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>(.x <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>life_exp_nodeath  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">life_exp =</span> <span class="fu">as.matrix</span>(tr) <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alt_simp</span>(.,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  {. <span class="sc">*</span> cycle} <span class="sc">%&gt;%</span> {.<span class="sc">/</span><span class="dv">1000</span>} ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">round</span>(.,<span class="dv">1</span>)}</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>life_exp_nodeath <span class="sc">%&gt;%</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"life_exp"</span><span class="ot">=</span><span class="st">"Total Life Expectancy"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="st">"Note that we are ignoring discounting"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-lifeexp-nodeath" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="qkkzryyalu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qkkzryyalu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qkkzryyalu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qkkzryyalu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qkkzryyalu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qkkzryyalu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qkkzryyalu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qkkzryyalu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qkkzryyalu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qkkzryyalu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qkkzryyalu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qkkzryyalu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qkkzryyalu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qkkzryyalu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qkkzryyalu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qkkzryyalu .gt_from_md > :first-child {
  margin-top: 0;
}

#qkkzryyalu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qkkzryyalu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qkkzryyalu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qkkzryyalu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qkkzryyalu .gt_row_group_first td {
  border-top-width: 2px;
}

#qkkzryyalu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qkkzryyalu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qkkzryyalu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qkkzryyalu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qkkzryyalu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qkkzryyalu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qkkzryyalu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qkkzryyalu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qkkzryyalu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qkkzryyalu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qkkzryyalu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qkkzryyalu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qkkzryyalu .gt_left {
  text-align: left;
}

#qkkzryyalu .gt_center {
  text-align: center;
}

#qkkzryyalu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qkkzryyalu .gt_font_normal {
  font-weight: normal;
}

#qkkzryyalu .gt_font_bold {
  font-weight: bold;
}

#qkkzryyalu .gt_font_italic {
  font-style: italic;
}

#qkkzryyalu .gt_super {
  font-size: 65%;
}

#qkkzryyalu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qkkzryyalu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qkkzryyalu .gt_indent_1 {
  text-indent: 5px;
}

#qkkzryyalu .gt_indent_2 {
  text-indent: 10px;
}

#qkkzryyalu .gt_indent_3 {
  text-indent: 15px;
}

#qkkzryyalu .gt_indent_4 {
  text-indent: 20px;
}

#qkkzryyalu .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="Total Life Expectancy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total Life Expectancy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="life_exp">60</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td class="gt_sourcenote">Note that we are ignoring discounting</td>
</tr>
</tfoot>

</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;3: Total Life Expectancy in a Scenario with No Death (or Discounting)</figcaption>
</figure>
</div>
</div>
<p>Not surprisingly, when there is no death or discounting, over a 60 year horizon life expectancy is 60.</p>
<p>Finally, letâ€™s make one more tweak and switch from a yearly to a monthly time cycle. Again, we find identical answers for both the total number who become sick (after 2 years), and for life expectancy.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>) <span class="sc">%*%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)),<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)),<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>),<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>))) <span class="sc">%^%</span> (<span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-nodeathdaily" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="vndjipjcsk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vndjipjcsk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vndjipjcsk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vndjipjcsk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vndjipjcsk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vndjipjcsk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vndjipjcsk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vndjipjcsk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vndjipjcsk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vndjipjcsk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vndjipjcsk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vndjipjcsk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vndjipjcsk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vndjipjcsk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vndjipjcsk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vndjipjcsk .gt_from_md > :first-child {
  margin-top: 0;
}

#vndjipjcsk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vndjipjcsk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vndjipjcsk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vndjipjcsk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vndjipjcsk .gt_row_group_first td {
  border-top-width: 2px;
}

#vndjipjcsk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vndjipjcsk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vndjipjcsk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vndjipjcsk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vndjipjcsk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vndjipjcsk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vndjipjcsk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vndjipjcsk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vndjipjcsk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vndjipjcsk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vndjipjcsk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vndjipjcsk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vndjipjcsk .gt_left {
  text-align: left;
}

#vndjipjcsk .gt_center {
  text-align: center;
}

#vndjipjcsk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vndjipjcsk .gt_font_normal {
  font-weight: normal;
}

#vndjipjcsk .gt_font_bold {
  font-weight: bold;
}

#vndjipjcsk .gt_font_italic {
  font-style: italic;
}

#vndjipjcsk .gt_super {
  font-size: 65%;
}

#vndjipjcsk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#vndjipjcsk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vndjipjcsk .gt_indent_1 {
  text-indent: 5px;
}

#vndjipjcsk .gt_indent_2 {
  text-indent: 10px;
}

#vndjipjcsk .gt_indent_3 {
  text-indent: 15px;
}

#vndjipjcsk .gt_indent_4 {
  text-indent: 20px;
}

#vndjipjcsk .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Healthy">740.8182</td>
<td class="gt_row gt_right" headers="Sick">259.1818</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;4: State Occpancy with No Death</figcaption>
</figure>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span>({</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>) <span class="sc">%*%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span><span class="sc">/</span><span class="dv">12</span>),<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span><span class="sc">/</span><span class="dv">12</span>),<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>),<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>))) <span class="sc">%^%</span> .x) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  }))  <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>(.x <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>life_exp_nodeath  <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">life_exp =</span> <span class="fu">as.matrix</span>(tr) <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alt_simp</span>(.,<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  {. <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)} <span class="sc">%&gt;%</span> {.<span class="sc">/</span><span class="dv">1000</span>} ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">round</span>(.,<span class="dv">1</span>)}</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>life_exp_nodeath <span class="sc">%&gt;%</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"life_exp"</span><span class="ot">=</span><span class="st">"Total Life Expectancy"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="st">"Note that we are ignoring discounting"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-lifeexp-nodeath-monthly" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="kvjhdhsphf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#kvjhdhsphf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvjhdhsphf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvjhdhsphf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvjhdhsphf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvjhdhsphf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvjhdhsphf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvjhdhsphf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvjhdhsphf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvjhdhsphf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvjhdhsphf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvjhdhsphf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvjhdhsphf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvjhdhsphf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvjhdhsphf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvjhdhsphf .gt_from_md > :first-child {
  margin-top: 0;
}

#kvjhdhsphf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvjhdhsphf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvjhdhsphf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvjhdhsphf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvjhdhsphf .gt_row_group_first td {
  border-top-width: 2px;
}

#kvjhdhsphf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvjhdhsphf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvjhdhsphf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvjhdhsphf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvjhdhsphf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvjhdhsphf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvjhdhsphf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvjhdhsphf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvjhdhsphf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvjhdhsphf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvjhdhsphf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvjhdhsphf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvjhdhsphf .gt_left {
  text-align: left;
}

#kvjhdhsphf .gt_center {
  text-align: center;
}

#kvjhdhsphf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvjhdhsphf .gt_font_normal {
  font-weight: normal;
}

#kvjhdhsphf .gt_font_bold {
  font-weight: bold;
}

#kvjhdhsphf .gt_font_italic {
  font-style: italic;
}

#kvjhdhsphf .gt_super {
  font-size: 65%;
}

#kvjhdhsphf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#kvjhdhsphf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvjhdhsphf .gt_indent_1 {
  text-indent: 5px;
}

#kvjhdhsphf .gt_indent_2 {
  text-indent: 10px;
}

#kvjhdhsphf .gt_indent_3 {
  text-indent: 15px;
}

#kvjhdhsphf .gt_indent_4 {
  text-indent: 20px;
}

#kvjhdhsphf .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="Total Life Expectancy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total Life Expectancy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="life_exp">60</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="even">
<td class="gt_sourcenote">Note that we are ignoring discounting</td>
</tr>
</tfoot>

</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;5: Monthly Life Cycle - Total Life Expectancy in a Scenario with No Death (or Discounting)</figcaption>
</figure>
</div>
</div>
</section>
<section id="act-2-here-be-competing-risks-dragons" class="level1 page-columns page-full">
<h1>Act 2: Here Be (Competing Risks) Dragons</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>) <span class="sc">%*%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)),<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>.<span class="dv">15</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)),<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>),<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>))) <span class="sc">%^%</span> (<span class="dv">2</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With the knowledge that in a world without death, approximately 259 people would become ill after 2 years, and would expect to live for 60 years on average, what happens when we introduce death as a competing risk?</p>
<p>Letâ€™s now set the background mortality rate <span class="math inline">\(r_{HD}\)</span> to 0.006. Letâ€™s also assume that the hazard rate for death among sick people is 10 times the death rate of healthy people (i.e., <span class="math inline">\(r_{SD} = 10 \cdot r_{HD}\)</span>).</p>
<p>Note that death is only a competing risk for the Healthy state, since if someone is sick, death is the only other state they can transition out to:</p>
<div class="cell" data-fig-width="4" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<svg width="384" height="480" viewbox="0.00 0.00 171.02 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 167.02,-184 167.02,4 -4,4"></polygon> <!-- Healthy --> <g id="node1" class="node">
<title>
Healthy
</title>
<ellipse fill="none" stroke="black" cx="41.61" cy="-90" rx="41.71" ry="18"></ellipse> <text text-anchor="middle" x="41.61" y="-85.8" font-family="Times,serif" font-size="14.00">Healthy</text> </g> <!-- Healthy&#45;&gt;Healthy --> <g id="edge1" class="edge">
<title>
Healthy-&gt;Healthy
</title>
<path fill="none" stroke="black" d="M80.3,-96.74C92.04,-96.57 101.21,-94.32 101.21,-90 101.21,-87.03 96.88,-85.04 90.35,-84.03"></path> <polygon fill="black" stroke="black" points="90.54,-80.53 80.3,-83.26 90.01,-87.51 90.54,-80.53"></polygon> </g> <!-- Sick --> <g id="node2" class="node">
<title>
Sick
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-162" rx="28.41" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-157.8" font-family="Times,serif" font-size="14.00">Sick</text> </g> <!-- Healthy&#45;&gt;Sick --> <g id="edge3" class="edge">
<title>
Healthy-&gt;Sick
</title>
<path fill="none" stroke="red" d="M58.31,-106.7C67.93,-116.33 80.17,-128.57 90.69,-139.09"></path> <polygon fill="red" stroke="red" points="88.44,-141.78 97.98,-146.38 93.39,-136.83 88.44,-141.78"></polygon> </g> <!-- Dead --> <g id="node3" class="node">
<title>
Dead
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-18" rx="31.32" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-13.8" font-family="Times,serif" font-size="14.00">Dead</text> </g> <!-- Healthy&#45;&gt;Dead --> <g id="edge5" class="edge">
<title>
Healthy-&gt;Dead
</title>
<path fill="none" stroke="red" d="M58.31,-73.3C67.93,-63.67 80.17,-51.43 90.69,-40.91"></path> <polygon fill="red" stroke="red" points="93.39,-43.17 97.98,-33.62 88.44,-38.22 93.39,-43.17"></polygon> </g> <!-- Sick&#45;&gt;Sick --> <g id="edge2" class="edge">
<title>
Sick-&gt;Sick
</title>
<path fill="none" stroke="black" d="M140.2,-168.71C150.86,-169.09 159.81,-166.85 159.81,-162 159.81,-158.82 155.96,-156.76 150.29,-155.83"></path> <polygon fill="black" stroke="black" points="150.37,-152.33 140.2,-155.29 150,-159.32 150.37,-152.33"></polygon> </g> <!-- Sick&#45;&gt;Dead --> <g id="edge4" class="edge">
<title>
Sick-&gt;Dead
</title>
<path fill="none" stroke="black" d="M113.61,-143.76C113.61,-119.2 113.61,-75.25 113.61,-46.35"></path> <polygon fill="black" stroke="black" points="117.11,-46.09 113.61,-36.09 110.11,-46.09 117.11,-46.09"></polygon> </g> <!-- Dead&#45;&gt;Dead --> <g id="edge6" class="edge">
<title>
Dead-&gt;Dead
</title>
<path fill="none" stroke="black" d="M143.03,-24.74C153.99,-24.96 163.02,-22.71 163.02,-18 163.02,-14.91 159.13,-12.88 153.36,-11.91"></path> <polygon fill="black" stroke="black" points="153.23,-8.4 143.03,-11.26 152.79,-15.38 153.23,-8.4"></polygon> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<section id="standard-rate-to-transition-conversion" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="standard-rate-to-transition-conversion">Standard Rate-to-Transition Conversion</h2>
<p>Letâ€™s first convert the supplied rates to probabilities using the same standard formulas, as above:</p>
<p><span class="math display">\[
p_{HS}= 1 - e^{-r_{HS}\cdot \Delta t}
\]</span></p>
<p><span class="math display">\[
p_{HD} = 1 - e^{-r_{HD}\cdot \Delta t}
\]</span></p>
<p>We can also define the probability of remaining healthy (i.e., transitioning to <em>neither</em> the sick or dead state) as:</p>
<p><span class="math display">\[
p_{HH} = 1 - p_{HS} - p_{HD}= e^{-r_{HS}\Delta t}  + e^{-r_{HD}\Delta t} - 1
\]</span></p>
<p>And finally the probability of dying among sick people is defined as</p>
<p><span class="math display">\[
p_{SD} = 1 - e^{-hr_{HD}\cdot r_{HD}\cdot \Delta t}
\]</span></p>
<p><a href="#fig-m_P-st">Figure&nbsp;6</a> shows the corresponding transition probability matrix:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>r_HD <span class="ot">&lt;-</span> <span class="fl">0.006</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>r_SD <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">0.006</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_P</span>(<span class="at">r_HS=</span>r_HS,<span class="at">r_HD=</span>r_HD,<span class="at">r_SD=</span>r_SD,<span class="at">cycle=</span>cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"P_st"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#column_to_rownames("from") %&gt;% </span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>from), <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"from"</span><span class="ot">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-m_P-st" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="zovlpupyxo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zovlpupyxo .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zovlpupyxo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zovlpupyxo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zovlpupyxo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zovlpupyxo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zovlpupyxo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zovlpupyxo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zovlpupyxo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zovlpupyxo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zovlpupyxo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zovlpupyxo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zovlpupyxo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zovlpupyxo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zovlpupyxo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zovlpupyxo .gt_from_md > :first-child {
  margin-top: 0;
}

#zovlpupyxo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zovlpupyxo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zovlpupyxo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zovlpupyxo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zovlpupyxo .gt_row_group_first td {
  border-top-width: 2px;
}

#zovlpupyxo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zovlpupyxo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zovlpupyxo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zovlpupyxo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zovlpupyxo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zovlpupyxo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zovlpupyxo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zovlpupyxo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zovlpupyxo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zovlpupyxo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zovlpupyxo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zovlpupyxo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zovlpupyxo .gt_left {
  text-align: left;
}

#zovlpupyxo .gt_center {
  text-align: center;
}

#zovlpupyxo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zovlpupyxo .gt_font_normal {
  font-weight: normal;
}

#zovlpupyxo .gt_font_bold {
  font-weight: bold;
}

#zovlpupyxo .gt_font_italic {
  font-style: italic;
}

#zovlpupyxo .gt_super {
  font-size: 65%;
}

#zovlpupyxo .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zovlpupyxo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zovlpupyxo .gt_indent_1 {
  text-indent: 5px;
}

#zovlpupyxo .gt_indent_2 {
  text-indent: 10px;
}

#zovlpupyxo .gt_indent_3 {
  text-indent: 15px;
}

#zovlpupyxo .gt_indent_4 {
  text-indent: 20px;
}

#zovlpupyxo .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
<th id="Dead" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dead</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="from">Healthy</td>
<td class="gt_row gt_right" headers="Healthy">0.8547</td>
<td class="gt_row gt_right" headers="Sick">0.1393</td>
<td class="gt_row gt_right" headers="Dead">0.0060</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="from">Sick</td>
<td class="gt_row gt_right" headers="Healthy">0.0000</td>
<td class="gt_row gt_right" headers="Sick">0.9418</td>
<td class="gt_row gt_right" headers="Dead">0.0582</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="from">Dead</td>
<td class="gt_row gt_right" headers="Healthy">0.0000</td>
<td class="gt_row gt_right" headers="Sick">0.0000</td>
<td class="gt_row gt_right" headers="Dead">1.0000</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;6: Transition Probability Matrix Using Standard Rate-to-Probability Conversion Formulas</figcaption>
</figure>
</div>
</div>
<p>Given this transition probability matrix, how many healthy, sick and dead individuals do we have in our cohort after a 60-year time horizon? <a href="#fig-60y-st">Figure&nbsp;7</a> summarizes state occupancy at the end of 60 years:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>res_60yst <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_sens</span>(<span class="at">r_HD=</span> r_HD, <span class="at">r_HS =</span> r_HS, <span class="at">r_SD =</span> r_SD, <span class="at">cycle=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"P_st"</span>) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>res_60yst <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle,Healthy,Sick,Dead,life_exp) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(<span class="at">missing_text=</span><span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(Healthy,Sick,Dead,life_exp),<span class="at">decimals=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"life_exp"</span> <span class="ot">=</span> <span class="st">"Life Expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-60y-st" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="ehjastmmfn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ehjastmmfn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ehjastmmfn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ehjastmmfn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ehjastmmfn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ehjastmmfn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ehjastmmfn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ehjastmmfn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ehjastmmfn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ehjastmmfn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ehjastmmfn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ehjastmmfn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ehjastmmfn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ehjastmmfn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ehjastmmfn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ehjastmmfn .gt_from_md > :first-child {
  margin-top: 0;
}

#ehjastmmfn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ehjastmmfn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ehjastmmfn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ehjastmmfn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ehjastmmfn .gt_row_group_first td {
  border-top-width: 2px;
}

#ehjastmmfn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehjastmmfn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ehjastmmfn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ehjastmmfn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ehjastmmfn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehjastmmfn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ehjastmmfn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ehjastmmfn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ehjastmmfn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ehjastmmfn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehjastmmfn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ehjastmmfn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ehjastmmfn .gt_left {
  text-align: left;
}

#ehjastmmfn .gt_center {
  text-align: center;
}

#ehjastmmfn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ehjastmmfn .gt_font_normal {
  font-weight: normal;
}

#ehjastmmfn .gt_font_bold {
  font-weight: bold;
}

#ehjastmmfn .gt_font_italic {
  font-style: italic;
}

#ehjastmmfn .gt_super {
  font-size: 65%;
}

#ehjastmmfn .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ehjastmmfn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ehjastmmfn .gt_indent_1 {
  text-indent: 5px;
}

#ehjastmmfn .gt_indent_2 {
  text-indent: 10px;
}

#ehjastmmfn .gt_indent_3 {
  text-indent: 15px;
}

#ehjastmmfn .gt_indent_4 {
  text-indent: 20px;
}

#ehjastmmfn .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="cycle" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cycle</th>
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
<th id="Dead" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dead</th>
<th id="Life Expectancy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Life Expectancy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="cycle">60</td>
<td class="gt_row gt_right" headers="Healthy">0.1</td>
<td class="gt_row gt_right" headers="Sick">43.6</td>
<td class="gt_row gt_right" headers="Dead">956.3</td>
<td class="gt_row gt_right" headers="life_exp">22.1</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;7: 1-Year Cycle</figcaption>
</figure>
</div>
</div>
<p>As <a href="#fig-60y-st">Figure&nbsp;7</a> shows, after 60 years, 43.6 are recorded as being in the sick state and life expectancy has reduced to 22.1 years.</p>
<p>As above, letâ€™s now repeat the same exercise using a <em>daily</em> cycle length:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>res_60yst_daily <span class="ot">&lt;-</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_sens</span>(<span class="at">r_HD=</span> r_HD, <span class="at">r_HS =</span> r_HS, <span class="at">r_SD =</span> r_SD,<span class="at">cycle=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"P_st"</span>) </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>res_60yst_daily <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle,Healthy,Sick,Dead,life_exp) <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(<span class="at">missing_text=</span><span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(Healthy,Sick,Dead,life_exp),<span class="at">decimals=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"life_exp"</span> <span class="ot">=</span> <span class="st">"Life Expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-60y-st-daily" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="fqczstisrm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fqczstisrm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fqczstisrm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqczstisrm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fqczstisrm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fqczstisrm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fqczstisrm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqczstisrm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqczstisrm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fqczstisrm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fqczstisrm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fqczstisrm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fqczstisrm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fqczstisrm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fqczstisrm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fqczstisrm .gt_from_md > :first-child {
  margin-top: 0;
}

#fqczstisrm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fqczstisrm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fqczstisrm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fqczstisrm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fqczstisrm .gt_row_group_first td {
  border-top-width: 2px;
}

#fqczstisrm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqczstisrm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fqczstisrm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fqczstisrm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqczstisrm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqczstisrm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fqczstisrm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fqczstisrm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqczstisrm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqczstisrm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqczstisrm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqczstisrm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqczstisrm .gt_left {
  text-align: left;
}

#fqczstisrm .gt_center {
  text-align: center;
}

#fqczstisrm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fqczstisrm .gt_font_normal {
  font-weight: normal;
}

#fqczstisrm .gt_font_bold {
  font-weight: bold;
}

#fqczstisrm .gt_font_italic {
  font-style: italic;
}

#fqczstisrm .gt_super {
  font-size: 65%;
}

#fqczstisrm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#fqczstisrm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fqczstisrm .gt_indent_1 {
  text-indent: 5px;
}

#fqczstisrm .gt_indent_2 {
  text-indent: 10px;
}

#fqczstisrm .gt_indent_3 {
  text-indent: 15px;
}

#fqczstisrm .gt_indent_4 {
  text-indent: 20px;
}

#fqczstisrm .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="cycle" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cycle</th>
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
<th id="Dead" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dead</th>
<th id="Life Expectancy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Life Expectancy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="cycle">21900</td>
<td class="gt_row gt_right" headers="Healthy">0.1</td>
<td class="gt_row gt_right" headers="Sick">42.6</td>
<td class="gt_row gt_right" headers="Dead">957.4</td>
<td class="gt_row gt_right" headers="life_exp">21.7</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;8: Daily Cycle</figcaption>
</figure>
</div>
</div>
<p>By switching to a daily cycle we now have 42.6 recorded as being in the sick state after 60 years (=21,900 days) and life expectancy is 21.7 years.</p>
<section id="signs-of-trouble" class="level3">
<h3 class="anchored" data-anchor-id="signs-of-trouble">Signs of Trouble</h3>
<p>Letâ€™s recap what we have found after introducing background mortality as a competing risk:</p>
<ul>
<li>Using a <strong>1-year cycle length</strong>, life expectancy is 22.11 years.</li>
<li>Using a <strong>daily cycle length</strong>, life expectancy is 21.73 years.</li>
</ul>
<p>The only difference above is the cycle length used, yet we obtain a 0.38 year difference in life expectancy. What causes this difference?</p>
</section>
<section id="discretizing-a-continuous-time-process" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="discretizing-a-continuous-time-process">Discretizing a Continuous Time Process</h3>
<p>The answer boils down to the fact that with longer cycle lengths we â€œhideâ€ some deaths that occur because a full healthy sick dead transition occurs within a single cycle.</p>
<p>When we use the standard rate-to-probability conversion formula (i.e., <span class="math inline">\(p_{HS}= 1 - e^{-r_{HS}\Delta t}\)</span>) we obtain the <em>marginal</em> probability of transition. This marginal probability reflects the union of <em>all possible transitions</em> that start Healthy and then transition to and from the sick state in the cycle.</p>
<p>That is, <span class="math inline">\(p_{HS}= 1 - e^{-r_{HS}\Delta t}\)</span> captures the probability of following scenarios occurring in a cycle:</p>
<ol type="1">
<li>Individual transitions from healthy to sick.</li>
<li>Individual transitions from healthy to sick to dead.</li>
</ol>
<p>By including case 2 in the healthy sick transition probability, we effectively rule out the possibility of becoming sick and dying within the same cycle. This implicit assumption means that we are no longer modeling a continuous time process, since we effectively â€œhideâ€ some (quick) deaths that occur within a cycle due to the disease:</p>
<div class="cell" data-fig-width="4" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-comp-st" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<div>
<svg width="384" height="480" viewbox="0.00 0.00 171.02 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 167.02,-184 167.02,4 -4,4"></polygon> <!-- Healthy --> <g id="node1" class="node">
<title>
Healthy
</title>
<ellipse fill="#81aede" stroke="black" cx="41.61" cy="-90" rx="41.71" ry="18"></ellipse> <text text-anchor="middle" x="41.61" y="-85.8" font-family="Times,serif" font-size="14.00">Healthy</text> </g> <!-- Healthy&#45;&gt;Healthy --> <g id="edge1" class="edge">
<title>
Healthy-&gt;Healthy
</title>
<path fill="none" stroke="#d9d0d0" d="M80.3,-96.74C92.04,-96.57 101.21,-94.32 101.21,-90 101.21,-87.03 96.88,-85.04 90.35,-84.03"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="90.54,-80.53 80.3,-83.26 90.01,-87.51 90.54,-80.53"></polygon> </g> <!-- Sick --> <g id="node2" class="node">
<title>
Sick
</title>
<ellipse fill="#81aede" stroke="black" cx="113.61" cy="-162" rx="28.41" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-157.8" font-family="Times,serif" font-size="14.00">Sick</text> </g> <!-- Healthy&#45;&gt;Sick --> <g id="edge3" class="edge">
<title>
Healthy-&gt;Sick
</title>
<path fill="none" stroke="blue" stroke-width="3" d="M58.31,-106.7C67.93,-116.33 80.17,-128.57 90.69,-139.09"></path> <polygon fill="blue" stroke="blue" stroke-width="3" points="88.44,-141.78 97.98,-146.38 93.39,-136.83 88.44,-141.78"></polygon> </g> <!-- Dead --> <g id="node3" class="node">
<title>
Dead
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-18" rx="31.32" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-13.8" font-family="Times,serif" font-size="14.00">Dead</text> </g> <!-- Healthy&#45;&gt;Dead --> <g id="edge5" class="edge">
<title>
Healthy-&gt;Dead
</title>
<path fill="none" stroke="#d9d0d0" d="M58.31,-73.3C67.93,-63.67 80.17,-51.43 90.69,-40.91"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="93.39,-43.17 97.98,-33.62 88.44,-38.22 93.39,-43.17"></polygon> </g> <!-- Sick&#45;&gt;Sick --> <g id="edge2" class="edge">
<title>
Sick-&gt;Sick
</title>
<path fill="none" stroke="#d9d0d0" d="M140.2,-168.71C150.86,-169.09 159.81,-166.85 159.81,-162 159.81,-158.82 155.96,-156.76 150.29,-155.83"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="150.37,-152.33 140.2,-155.29 150,-159.32 150.37,-152.33"></polygon> </g> <!-- Sick&#45;&gt;Dead --> <g id="edge4" class="edge">
<title>
Sick-&gt;Dead
</title>
<path fill="none" stroke="red" stroke-width="3" stroke-dasharray="1,5" d="M113.61,-143.76C113.61,-119.2 113.61,-75.25 113.61,-46.35"></path> <polygon fill="red" stroke="red" stroke-width="3" points="117.11,-46.09 113.61,-36.09 110.11,-46.09 117.11,-46.09"></polygon> </g> <!-- Dead&#45;&gt;Dead --> <g id="edge6" class="edge">
<title>
Dead-&gt;Dead
</title>
<path fill="none" stroke="#d9d0d0" d="M143.03,-24.74C153.99,-24.96 163.02,-22.71 163.02,-18 163.02,-14.91 159.13,-12.88 153.36,-11.91"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="153.23,-8.4 143.03,-11.26 152.79,-15.38 153.23,-8.4"></polygon> </g> </g>
</svg>
</div>
<figcaption class="figure-caption">Figure&nbsp;9: compound Transition Patterns Using Standard Rate to Probability Conversion Formulas</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-comp-st">Figure&nbsp;9</a>, and using standard rate-to-probability conversion formulas, the recorded states of a healthy sick dead transition are recorded in blue; the â€œhiddenâ€ transition is shown in red.</p>
<section id="alternative-rate-to-probability-conversion" class="level4">
<h4 class="anchored" data-anchor-id="alternative-rate-to-probability-conversion">Alternative Rate-to-Probability Conversion</h4>
<p>Another set of formulas often used to account for competing risks are as follows:</p>
<p><span class="math display">\[
p_{HS}= \frac{r_{HS}}{r_{HS}+r_{HD}}\big ( 1 - e^{-(r_{HS}+r_{HD})\Delta t}\big )
\]</span></p>
<p><span class="math display">\[
p_{HD}= \frac{r_{HD}}{r_{HS}+r_{HD}}\big ( 1 - e^{-(r_{HS}+r_{HD})\Delta t}\big )
\]</span></p>
<p><span class="math display">\[
p_{HH} = e^{-(r_{HS}+r_{HD})\Delta t}
\]</span></p>
<p>Letâ€™s now use these formulas instead.</p>
<p><a href="#fig-m_P-cr">Figure&nbsp;10</a> shows the corresponding transition probability matrix:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>r_HD <span class="ot">&lt;-</span> <span class="fl">0.006</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>r_SD <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">0.006</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_P</span>(<span class="at">r_HS=</span>r_HS,<span class="at">r_HD=</span>r_HD,<span class="at">r_SD=</span>r_SD,<span class="at">cycle=</span>cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"P_cr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#column_to_rownames("from") %&gt;% </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>from), <span class="sc">~</span><span class="fu">round</span>(.,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"from"</span><span class="ot">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-m_P-cr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="gqssspegsh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gqssspegsh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gqssspegsh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gqssspegsh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gqssspegsh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gqssspegsh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gqssspegsh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqssspegsh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gqssspegsh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gqssspegsh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gqssspegsh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gqssspegsh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gqssspegsh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gqssspegsh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gqssspegsh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gqssspegsh .gt_from_md > :first-child {
  margin-top: 0;
}

#gqssspegsh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gqssspegsh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gqssspegsh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gqssspegsh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gqssspegsh .gt_row_group_first td {
  border-top-width: 2px;
}

#gqssspegsh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqssspegsh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gqssspegsh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gqssspegsh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqssspegsh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqssspegsh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gqssspegsh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gqssspegsh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqssspegsh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gqssspegsh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqssspegsh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gqssspegsh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqssspegsh .gt_left {
  text-align: left;
}

#gqssspegsh .gt_center {
  text-align: center;
}

#gqssspegsh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gqssspegsh .gt_font_normal {
  font-weight: normal;
}

#gqssspegsh .gt_font_bold {
  font-weight: bold;
}

#gqssspegsh .gt_font_italic {
  font-style: italic;
}

#gqssspegsh .gt_super {
  font-size: 65%;
}

#gqssspegsh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#gqssspegsh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gqssspegsh .gt_indent_1 {
  text-indent: 5px;
}

#gqssspegsh .gt_indent_2 {
  text-indent: 10px;
}

#gqssspegsh .gt_indent_3 {
  text-indent: 15px;
}

#gqssspegsh .gt_indent_4 {
  text-indent: 20px;
}

#gqssspegsh .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
<th id="Dead" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dead</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="from">Healthy</td>
<td class="gt_row gt_right" headers="Healthy">0.8556</td>
<td class="gt_row gt_right" headers="Sick">0.1389</td>
<td class="gt_row gt_right" headers="Dead">0.0056</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="from">Sick</td>
<td class="gt_row gt_right" headers="Healthy">0.0000</td>
<td class="gt_row gt_right" headers="Sick">0.9418</td>
<td class="gt_row gt_right" headers="Dead">0.0582</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="from">Dead</td>
<td class="gt_row gt_right" headers="Healthy">0.0000</td>
<td class="gt_row gt_right" headers="Sick">0.0000</td>
<td class="gt_row gt_right" headers="Dead">1.0000</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;10: Transition Probability Matrix Using Alternative Rate-to-Probability Conversion Formulas</figcaption>
</figure>
</div>
</div>
<p>Comparing <a href="#fig-m_P-st">Figure&nbsp;6</a> and <a href="#fig-m_P-cr">Figure&nbsp;10</a>, notice that a few things have changed. First, the probability of Healthy Sick transition declined. This would seem to be consistent with a world in which there are fewer alive sick individuals observed at the end of the cycleâ€“which we would expect if acute illness results in a nontrivial number of quick deaths after illness onset in a cycle.</p>
<p>However, look at the Healthy Dead transition probability change; <strong>it went down, too</strong>. If we were recording more acute deaths from the disease, we should see <em>more</em> Healthy Dead transitions from individuals sojourning through the Sick state on their way to death in a single cycle.</p>
<p>What about state occupancy and life expectancy under different cycle lengths?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>res_60yst_cr <span class="ot">&lt;-</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_sens</span>(<span class="at">r_HD=</span> r_HD, <span class="at">r_HS =</span> r_HS, <span class="at">r_SD =</span> r_SD, <span class="at">cycle=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"P_cr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle =</span> <span class="st">"1y"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle_t =</span> <span class="dv">60</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>res_60yst_daily_cr <span class="ot">&lt;-</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">check_sens</span>(<span class="at">r_HD=</span> r_HD, <span class="at">r_HS =</span> r_HS, <span class="at">r_SD =</span> r_SD,<span class="at">cycle=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">==</span><span class="st">"P_cr"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle_t =</span> cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cycle =</span> <span class="st">"Daily"</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>res_60yst_cr <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(res_60yst_daily_cr) <span class="sc">%&gt;%</span> </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cycle,cycle_t,Healthy,Sick,Dead,life_exp) <span class="sc">%&gt;%</span> </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_missing</span>(<span class="at">missing_text=</span><span class="st">"-"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(Healthy,Sick,Dead,life_exp),<span class="at">decimals=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="st">"life_exp"</span> <span class="ot">=</span> <span class="st">"Life Expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-st-cr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<div id="gavydgqvae" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gavydgqvae .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gavydgqvae .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gavydgqvae .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gavydgqvae .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gavydgqvae .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gavydgqvae .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gavydgqvae .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gavydgqvae .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gavydgqvae .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gavydgqvae .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gavydgqvae .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gavydgqvae .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gavydgqvae .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gavydgqvae .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gavydgqvae .gt_from_md > :first-child {
  margin-top: 0;
}

#gavydgqvae .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gavydgqvae .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gavydgqvae .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gavydgqvae .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gavydgqvae .gt_row_group_first td {
  border-top-width: 2px;
}

#gavydgqvae .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gavydgqvae .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gavydgqvae .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gavydgqvae .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gavydgqvae .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gavydgqvae .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gavydgqvae .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gavydgqvae .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gavydgqvae .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gavydgqvae .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gavydgqvae .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gavydgqvae .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gavydgqvae .gt_left {
  text-align: left;
}

#gavydgqvae .gt_center {
  text-align: center;
}

#gavydgqvae .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gavydgqvae .gt_font_normal {
  font-weight: normal;
}

#gavydgqvae .gt_font_bold {
  font-weight: bold;
}

#gavydgqvae .gt_font_italic {
  font-style: italic;
}

#gavydgqvae .gt_super {
  font-size: 65%;
}

#gavydgqvae .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#gavydgqvae .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gavydgqvae .gt_indent_1 {
  text-indent: 5px;
}

#gavydgqvae .gt_indent_2 {
  text-indent: 10px;
}

#gavydgqvae .gt_indent_3 {
  text-indent: 15px;
}

#gavydgqvae .gt_indent_4 {
  text-indent: 20px;
}

#gavydgqvae .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true">
<thead class="gt_col_headings">
<tr class="header">
<th id="cycle" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">cycle</th>
<th id="cycle_t" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cycle_t</th>
<th id="Healthy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Healthy</th>
<th id="Sick" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sick</th>
<th id="Dead" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Dead</th>
<th id="Life Expectancy" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Life Expectancy</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="cycle">1y</td>
<td class="gt_row gt_right" headers="cycle_t">60</td>
<td class="gt_row gt_right" headers="Healthy">0.1</td>
<td class="gt_row gt_right" headers="Sick">43.9</td>
<td class="gt_row gt_right" headers="Dead">956.0</td>
<td class="gt_row gt_right" headers="life_exp">22.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="cycle">Daily</td>
<td class="gt_row gt_right" headers="cycle_t">21900</td>
<td class="gt_row gt_right" headers="Healthy">0.1</td>
<td class="gt_row gt_right" headers="Sick">42.6</td>
<td class="gt_row gt_right" headers="Dead">957.4</td>
<td class="gt_row gt_right" headers="life_exp">21.7</td>
</tr>
</tbody>
</table>

</div>
<figcaption class="figure-caption">Figure&nbsp;11: 1-Year vs.&nbsp;Daily Cycle</figcaption>
</figure>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>diff_st_cr <span class="ot">&lt;-</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  res_60yst_cr <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(res_60yst_daily_cr) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">life_exp =</span> life_exp<span class="sc">-</span><span class="fu">lead</span>(life_exp)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(life_exp) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">as.vector</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Again, we have a difference in life expectancy of 0.462 years. <em>So switching to the alternative formulas has not fundamentally solved our problem.</em></p>
</section>
<section id="how-do-transition-probabilities-change-as-the-likelihood-of-disease-related-death-varies" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="how-do-transition-probabilities-change-as-the-likelihood-of-disease-related-death-varies">How do transition probabilities change as the Likelihood of Disease-related death varies?</h4>
<p>Another way to see the issue is to plot how the transition probabilities change (or not) at different levels of disease acuity. <a href="#fig-acuity-comparison-1y">Figure&nbsp;12</a> plots the relevant transition probabilities under a yearly time cycle, and while allowing the underlying hazard rate of death from the disease (<code>hr_S</code>) to vary.</p>
<p>As the hazard rate increases, the likelihood of ending up dead within a given cycle increases. Indeed, in the most extreme case, imagine the disease has a near instantaneous death rate. In that case we should see almost no Healthy Sick transitions within a yearly cycle, because nearly everyone who became sick within the cycle died within 1 day.</p>
<p>We see in <a href="#fig-acuity-comparison-1y">Figure&nbsp;12</a> that the Healthy Sick probabilities remain flat for transitions under which background mortality is a competing event. However, the Sick Dead transition probabilities rise as the likelihood of fatal disease increases.</p>
<div class="cell page-columns page-full">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">get_P</span>(<span class="at">r_HS=</span>.<span class="dv">15</span>,<span class="at">r_HD=</span>.<span class="dv">006</span>,<span class="at">r_SD=</span>.<span class="dv">006</span><span class="sc">*</span>.x,<span class="at">cycle=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">hr_S=</span>.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(transition,value,<span class="sc">-</span>from,<span class="sc">-</span>name,<span class="sc">-</span>hr_S) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name,value) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_cr<span class="sc">!=</span><span class="dv">1</span> <span class="sc">&amp;</span> P_cr<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(method,value,<span class="sc">-</span>from,<span class="sc">-</span>hr_S,<span class="sc">-</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(method<span class="sc">!=</span><span class="st">"P_eQ"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(transition), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(from), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hr_S, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>method, <span class="at">shape=</span>method),<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(from<span class="sc">~</span>transition, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  directlabels<span class="sc">::</span><span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"  {method}"</span>)), <span class="at">method=</span><span class="st">"last.bumpup"</span>,<span class="at">hjust=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"hr_S (Hazard Ratio for Sick-to-Dead)"</span>,<span class="at">y =</span> <span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div id="fig-acuity-comparison-1y" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="embedding-a-transition-probability-matrix_files/figure-html/fig-acuity-comparison-1y-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;12: Yearly Cycle - Transition Probabilities by Sick-to-Dead Hazard Rate (P_st uses standard conversion formula; P_cr uses the formula that accounts for competing risks.)</figcaption>
</figure>
</div>
</div>
</div>
<p>It is common practice to address these issues using the following guidelines:</p>
<ul>
<li>Select a cycle length where the probability of remaining in a given state is at least 95%.</li>
<li>Pick a cycle length that aligns with the clinical/disease timelines of the decision problem.
<ul>
<li>Treatment schedules.</li>
<li>Acute vs.&nbsp;chronic condition.</li>
</ul></li>
</ul>
<p>But do these actually solve the issue? No. <a href="#fig-acuity-comparison-daily">Figure&nbsp;13</a> shows how the transition probabilities change when we switch to a <em>daily</em> cycle length. Again, we see the problem: as disease acuity increases, the probability of a Healthy Dead transition does not change; <strong>even though we shortened the cycle length, we have not fundamentally addressed the issue.</strong></p>
<div class="cell page-columns page-full">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">get_P</span>(<span class="at">r_HS=</span>.<span class="dv">15</span>,<span class="at">r_HD=</span>.<span class="dv">006</span>,<span class="at">r_SD=</span>.<span class="dv">006</span><span class="sc">*</span>.x,<span class="at">cycle=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">365</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">hr_S=</span>.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(transition,value,<span class="sc">-</span>from,<span class="sc">-</span>name,<span class="sc">-</span>hr_S) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name,value) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_cr<span class="sc">!=</span><span class="dv">1</span> <span class="sc">&amp;</span> P_cr<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(method,value,<span class="sc">-</span>from,<span class="sc">-</span>hr_S,<span class="sc">-</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(method<span class="sc">!=</span><span class="st">"P_eQ"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(transition), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(from), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hr_S, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>method, <span class="at">shape=</span>method),<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(from<span class="sc">~</span>transition, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  directlabels<span class="sc">::</span><span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"  {method}"</span>)), <span class="at">method=</span><span class="st">"last.bumpup"</span>,<span class="at">hjust=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"hr_S (Hazard Ratio for Sick-to-Dead)"</span>,<span class="at">y =</span> <span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div id="fig-acuity-comparison-daily" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="embedding-a-transition-probability-matrix_files/figure-html/fig-acuity-comparison-daily-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;13: Daily Cycle - Transition Probabilities by Sick-to-Dead Hazard Rate (P_st uses standard conversion formula; P_cr uses the formula that accounts for competing risks.)</figcaption>
</figure>
</div>
</div>
</div>
<p>How does this all translate into model outputs, such as life expectancy? <a href="#fig-le-st">Figure&nbsp;14</a> plots life-expectancy (y-axis) against the underlying disease hazard rate for death. Each line provides the life-expectancy curve under a different cycle length, with everything else in the model held fixed.</p>
<p>Not surprisingly, we see that as the likelihood of fatal disease increases, life expectancy declines.</p>
<p>But the most important takeaway is that the modeled life expectancy differs <em>depending on the cycle length used.</em> For a given hazard rate the underlying disease process is <em>exactly the same</em> â€“ but we get different answers depending on our cycle length.</p>
<p>The pattern of results is instructive, too. Essentially, with longer cycle lengths and incorrect transition probabilities, we will â€œmissâ€ more compound within-cycle Healthy Sick Dead transitions and instead record them as Healthy Sick transitions. This has a net effect of â€œhidingâ€ more disease-related death in our model â€“ and life-expectancy is inflated as a result.</p>
<div class="cell page-columns page-full" data-meassage="false">
<div class="cell-output-display column-page">
<div id="fig-le-st" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="embedding-a-transition-probability-matrix_files/figure-html/fig-le-st-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption class="figure-caption">Figure&nbsp;14: Life Expectancy by Sick-to-Dead Hazard Rate and Cycle Length. The left panel uses the formula that accounts for competing risks. The right panel uses standard conversion formula.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="act-iii-embedding-a-transition-matrix-and-recording-events" class="level1 page-columns page-full">
<h1>Act III: Embedding a Transition Matrix and Recording Events</h1>
<p>To properly account for compound transitions that can occur due to competing risks, we need to do the following:</p>
<ol type="1">
<li>Embed the transition probability matrix by exponentiating the underlying transition rate matrix.</li>
<li>Include non-Markovian accumulators in the transition probability matrix. This facilitates accurately calculating model outputs (e.g., total costs, QALYs, etc.).</li>
</ol>
<section id="embed-the-transition-probability-matrix" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="embed-the-transition-probability-matrix">1. Embed the Transition Probability Matrix</h2>
<p>Our rate matrix <code>Q</code> is constructed by including the relevant transition rates in the off-diagonal cells. The diagonal of <code>Q</code> is the negative sum of off-diagonal elements in the same row:</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Healthy</th>
<th>Sick</th>
<th>Dead</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Healthy</td>
<td>-(<span class="math inline">\(r_{HS}\)</span> + <span class="math inline">\(r_{HD}\)</span>)</td>
<td><span class="math inline">\(r_{HS}\)</span></td>
<td><span class="math inline">\(r_{HD}\)</span></td>
</tr>
<tr class="even">
<td>Sick</td>
<td>0</td>
<td>-(<span class="math inline">\(hr_{S} \cdot r_{HD}\)</span>)</td>
<td><span class="math inline">\(hr_{S} \cdot r_{HD}\)</span></td>
</tr>
<tr class="odd">
<td>Dead</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Here is the rate matrix for the Healthy-Sick-Dead model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">r_HS =</span> <span class="fl">0.15</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">r_HD =</span> <span class="fl">0.006</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">hr_S =</span> <span class="dv">10</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">cycle =</span> <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(params,{</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="sc">-</span>(r_HS<span class="sc">*</span>cycle<span class="sc">+</span>r_HD<span class="sc">*</span>cycle),r_HS<span class="sc">*</span>cycle,r_HD<span class="sc">*</span>cycle,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="sc">-</span>r_SD<span class="sc">*</span>cycle,r_SD<span class="sc">*</span>cycle,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow=</span><span class="dv">3</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span><span class="dv">3</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">byrow=</span><span class="cn">TRUE</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>), <span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>Q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Healthy  Sick  Dead
Healthy  -0.156  0.15 0.006
Sick      0.000 -0.06 0.060
Dead      0.000  0.00 0.000</code></pre>
</div>
</div>
<p>We next embed the transition probability matrix <code>P</code> by taking the matrix exponential of <code>Q</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expm)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">expm</span>(Q)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>P</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Healthy      Sick        Dead
Healthy 0.8555592 0.1346958 0.009744961
Sick    0.0000000 0.9417645 0.058235466
Dead    0.0000000 0.0000000 1.000000000</code></pre>
</div>
</div>
<p>An alternative way of exponentiating a matrix is to perform a Taylor series expansion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identity matrix with same dimensions and names as Q </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Q_I <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(Q_I) <span class="ot">=</span> <span class="fu">dimnames</span>(Q)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the %^% operator is in the expm package. </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">=</span> Q <span class="sc">%^%</span> <span class="dv">2</span>   <span class="co"># Q-squared</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">=</span> Q <span class="sc">%^%</span> <span class="dv">3</span>   <span class="co"># Q-cubed</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">=</span> Q <span class="sc">%^%</span> <span class="dv">4</span>   <span class="co"># etc.</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>Q_I <span class="sc">+</span> Q <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">2</span>))<span class="sc">*</span>Q2 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">3</span>))<span class="sc">*</span>Q3 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">factorial</span>(<span class="dv">4</span>))<span class="sc">*</span>Q4 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Healthy      Sick        Dead
Healthy 0.8555599 0.1346947 0.009745373
Sick    0.0000000 0.9417645 0.058235460
Dead    0.0000000 0.0000000 1.000000000</code></pre>
</div>
</div>
<p>How does this approach (<code>P_eQ</code>) perform relative to the other transition probability matrices (<code>P_st</code> and <code>P_cr</code>)? <a href="#fig-acuity-comparison-1y-embedded">Figure&nbsp;15</a> shows how the transition probabilities vary by hazard rate.</p>
<p>We can now see weâ€™ve achieved what we need: Healthy Dead transition probabilities that rise as the hazard rate of death from disease increases. Again, this occurs because as the likelihood of death after becoming ill increases, we increase the likelihood of a compound Healthy Sick Dead transition within a cycle. We need these to be recorded (accurately) as Healthy Dead transitions, rather than Healthy Sick transitions. Correspondingly, as the probability of a compound transition increases with an increasing hazard rate, the probability of a single Healthy Sick transition declines; we see this in <a href="#fig-acuity-comparison-1y-embedded">Figure&nbsp;15</a> as well.</p>
<div class="cell page-columns page-full">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="sc">~</span><span class="fu">get_P</span>(<span class="at">r_HS=</span>.<span class="dv">15</span>,<span class="at">r_HD=</span>.<span class="dv">006</span>,<span class="at">r_SD=</span>.<span class="dv">006</span><span class="sc">*</span>.x,<span class="at">cycle=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">hr_S=</span>.x)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(transition,value,<span class="sc">-</span>from,<span class="sc">-</span>name,<span class="sc">-</span>hr_S) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name,value) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(P_cr<span class="sc">!=</span><span class="dv">1</span> <span class="sc">&amp;</span> P_cr<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(method,value,<span class="sc">-</span>from,<span class="sc">-</span>hr_S,<span class="sc">-</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(method!="P_eQ") %&gt;% </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(transition), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(from), <span class="cf">function</span>(x) <span class="fu">factor</span>(x,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Healthy"</span>,<span class="st">"Sick"</span>,<span class="st">"Dead"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>transition) <span class="sc">%&gt;%</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hr_S, <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>method, <span class="at">shape=</span>method),<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">17</span>,<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(from<span class="sc">~</span>transition, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_base</span>() <span class="sc">+</span> </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult=</span>.<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"darkgreen"</span>,<span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  directlabels<span class="sc">::</span><span class="fu">geom_dl</span>(<span class="fu">aes</span>(<span class="at">label =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"  {method}"</span>)), <span class="at">method=</span><span class="st">"last.bumpup"</span>,<span class="at">hjust=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"hr_S (Hazard Ratio for Sick-to-Dead)"</span>,<span class="at">y =</span> <span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div id="fig-acuity-comparison-1y-embedded" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="embedding-a-transition-probability-matrix_files/figure-html/fig-acuity-comparison-1y-embedded-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;15: 1-Year Cycle - Transition Probabilities by Sick-to-Dead Hazard Rate (P_st uses standard conversion formula; P_cr uses the formula that accounts for competing risks, and P_eQ is embedded using the transition rate matrix Q.)</figcaption>
</figure>
</div>
</div>
</div>
<p>We also see that regardless of the cycle length used, we always end up with the same calculated life expectancy:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-le-eQ" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="embedding-a-transition-probability-matrix_files/figure-html/fig-le-eQ-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;16: Life Expectancy by Sick-to-Dead Hazard Rate and Cycle Length</figcaption>
</figure>
</div>
</div>
</div>
<p>We have thus â€œfixedâ€ our problem of hidden disease-related deaths!</p>
<section id="why-is-this-important" class="level3">
<h3 class="anchored" data-anchor-id="why-is-this-important">Why is this important?</h3>
<p>The use of an embedded transition probability matrix is important for a number of reasons:</p>
<ol type="1">
<li>The Markov model accurately reflects the underlying continuous time process.</li>
<li>We get an accurate accounting of disease-related deaths.</li>
<li>We can use whatever cycle length we need â€“ this facilitates computationally intensive processes such as probabilistic sensitivity analyses, which may not be feasible with a short (e.g., daily) cycle length.</li>
<li>We also avoid â€œstate explosionâ€ in the event our model has tunnel states. For example, if there is a one-year tunnel state for costs or utilities following disease onset, if we switched to a monthly or daily cycle weâ€™d have to build in dozens or more health states into our Markov model. Beacuse we can stick with a one-year cycle, this makes use of tunnel states much more feasible.</li>
</ol>
<p>The primary â€œcostâ€ of using this approach over standard rate-to-probability conversion formulas is that we must be a bit more careful in structuring our transition probability matrix to include accumulators used to aggregate model outputs. We will cover this process in the section directly below.</p>
</section>
</section>
<section id="include-non-markovian-accumulators-to-record-event-transitions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="include-non-markovian-accumulators-to-record-event-transitions">2. Include Non-Markovian Accumulators to Record Event Transitions</h2>
<p>We now have the correct transition probabilities to model the underlying continuous-time process, but how do we account for these compound transitions in our aggregation of model outputs?</p>
<p>Fundamentally, what we have now is a model that will correctly records the â€œtrueâ€ number of deaths at the end of the cycle, because all the compound Healthy Sick Dead transitions are included in the Healthy Dead transition probability.</p>
<p>To track the total number of transitions to Sick, we must augment our transition probability matrix with non-Markovian accumulators. This accumulator shows up as a purple edge in our model diagram below:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<svg width="672" height="480" viewbox="0.00 0.00 171.02 188.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>
G
</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-184 167.02,-184 167.02,4 -4,4"></polygon> <!-- Healthy --> <g id="node1" class="node">
<title>
Healthy
</title>
<ellipse fill="#81aede" stroke="black" cx="41.61" cy="-90" rx="41.71" ry="18"></ellipse> <text text-anchor="middle" x="41.61" y="-85.8" font-family="Times,serif" font-size="14.00">Healthy</text> </g> <!-- Healthy&#45;&gt;Healthy --> <g id="edge1" class="edge">
<title>
Healthy-&gt;Healthy
</title>
<path fill="none" stroke="#d9d0d0" d="M80.3,-96.74C92.04,-96.57 101.21,-94.32 101.21,-90 101.21,-87.03 96.88,-85.04 90.35,-84.03"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="90.54,-80.53 80.3,-83.26 90.01,-87.51 90.54,-80.53"></polygon> </g> <!-- Sick --> <g id="node2" class="node">
<title>
Sick
</title>
<ellipse fill="none" stroke="black" cx="113.61" cy="-162" rx="28.41" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-157.8" font-family="Times,serif" font-size="14.00">Sick</text> </g> <!-- Healthy&#45;&gt;Sick --> <g id="edge3" class="edge">
<title>
Healthy-&gt;Sick
</title>
<path fill="none" stroke="purple" stroke-width="3" stroke-dasharray="5,2" d="M58.31,-106.7C67.93,-116.33 80.17,-128.57 90.69,-139.09"></path> <polygon fill="purple" stroke="purple" stroke-width="3" points="88.44,-141.78 97.98,-146.38 93.39,-136.83 88.44,-141.78"></polygon> </g> <!-- Dead --> <g id="node3" class="node">
<title>
Dead
</title>
<ellipse fill="#81aede" stroke="black" cx="113.61" cy="-18" rx="31.32" ry="18"></ellipse> <text text-anchor="middle" x="113.61" y="-13.8" font-family="Times,serif" font-size="14.00">Dead</text> </g> <!-- Healthy&#45;&gt;Dead --> <g id="edge5" class="edge">
<title>
Healthy-&gt;Dead
</title>
<path fill="none" stroke="blue" stroke-width="3" d="M58.31,-73.3C67.93,-63.67 80.17,-51.43 90.69,-40.91"></path> <polygon fill="blue" stroke="blue" stroke-width="3" points="93.39,-43.17 97.98,-33.62 88.44,-38.22 93.39,-43.17"></polygon> </g> <!-- Sick&#45;&gt;Sick --> <g id="edge2" class="edge">
<title>
Sick-&gt;Sick
</title>
<path fill="none" stroke="#d9d0d0" d="M140.2,-168.71C150.86,-169.09 159.81,-166.85 159.81,-162 159.81,-158.82 155.96,-156.76 150.29,-155.83"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="150.37,-152.33 140.2,-155.29 150,-159.32 150.37,-152.33"></polygon> </g> <!-- Sick&#45;&gt;Dead --> <g id="edge4" class="edge">
<title>
Sick-&gt;Dead
</title>
<path fill="none" stroke="#d9d0d0" d="M113.61,-143.76C113.61,-119.2 113.61,-75.25 113.61,-46.35"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="117.11,-46.09 113.61,-36.09 110.11,-46.09 117.11,-46.09"></polygon> </g> <!-- Dead&#45;&gt;Dead --> <g id="edge6" class="edge">
<title>
Dead-&gt;Dead
</title>
<path fill="none" stroke="#d9d0d0" d="M143.03,-24.74C153.99,-24.96 163.02,-22.71 163.02,-18 163.02,-14.91 159.13,-12.88 153.36,-11.91"></path> <polygon fill="#d9d0d0" stroke="#d9d0d0" points="153.23,-8.4 143.03,-11.26 152.79,-15.38 153.23,-8.4"></polygon> </g> </g>
</svg>
</div>
</div>
</div>
</div>
<p>Fortunately, accumulators are easy to build in. We simply add the relevant transition rate in a new column in the transition rate matrix <code>Q</code>, <em>while leaving everything else the same.</em></p>
<p>Suppose we want to count up all the Healthy Sick transitions in the model. To do this we simply add the appropriate transition rate (<span class="math inline">\(r_{HS}\)</span>) in as an accumulator column:</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Healthy</th>
<th>Sick</th>
<th>Dead</th>
<th>accHS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Healthy</td>
<td>-(<span class="math inline">\(r_{HS}\)</span> + <span class="math inline">\(r_{HD}\)</span>)</td>
<td><span class="math inline">\(r_{HS}\)</span></td>
<td><span class="math inline">\(r_{HD}\)</span></td>
<td><span class="math inline">\(r_{HS}\)</span></td>
</tr>
<tr class="even">
<td>Sick</td>
<td>0</td>
<td>-(<span class="math inline">\(hr_{S} \cdot r_{HD}\)</span>)</td>
<td><span class="math inline">\(hr_{S} \cdot r_{HD}\)</span></td>
<td>0</td>
</tr>
<tr class="odd">
<td>Dead</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>accHS</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Note the following:</p>
<ul>
<li>An extra row of 0â€™s was added so that we balance the matrix, and ensure that we do not lose (or create!) anyone who becomes Sick.</li>
<li>We <strong>did not</strong> update the diagonal elements (i.e., the negative sum of transition rates); these stay the same as before.</li>
<li>If we wanted to add additional accumulators, we can just expand the matrix with more columns and rows as needed.</li>
</ul>
<p>Here is the augmented transition rate matrix for our example:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Q_ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Q)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Q_[<span class="st">"Healthy"</span>,<span class="st">"accHS"</span>] <span class="ot">&lt;-</span> params<span class="sc">$</span>r_HS</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Q_[<span class="st">"accHS"</span>,<span class="st">"accHS"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Q_[<span class="fu">is.na</span>(Q_)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Q_ <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Q_)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>Q_ </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Healthy  Sick  Dead accHS
Healthy  -0.156  0.15 0.006  0.15
Sick      0.000 -0.06 0.060  0.00
Dead      0.000  0.00 0.000  0.00
accHS     0.000  0.00 0.000  0.00</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>We next embed the transition probability matrix, as before:</p><div class="no-row-height column-margin column-container"><span class="">Notice that the accumulator (<code>accHS</code>) value is identical to the Healthy Sick transition probability we obtained using the alternative rate-to-probability conversion formula that accounted for competing risks (e.g., see <a href="#fig-m_P-cr">Figure&nbsp;10</a>).</span></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>P_ <span class="ot">&lt;-</span> <span class="fu">expm</span>(Q_)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>P_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Healthy      Sick        Dead     accHS
Healthy 0.8555592 0.1346958 0.009744961 0.1388854
Sick    0.0000000 0.9417645 0.058235466 0.0000000
Dead    0.0000000 0.0000000 1.000000000 0.0000000
accHS   0.0000000 0.0000000 0.000000000 1.0000000</code></pre>
</div>
</div>
<p>Using the accumulator we can accurately count up how many individuals transition to the Sick state over our time horizon:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m_trace <span class="ot">&lt;-</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span><span class="sc">:</span>(horizon<span class="sc">/</span>cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span>(<span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="sc">%*%</span> (P_<span class="sc">%^%</span>.x) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>m_trace[<span class="dv">3</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(.,<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">"cycle"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>cycle) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-state-2y-emb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">

<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Healthy
</th>
<th style="text-align:right;">
Sick
</th>
<th style="text-align:right;">
Dead
</th>
<th style="text-align:right;">
accHS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
731.98
</td>
<td style="text-align:right;">
242.09
</td>
<td style="text-align:right;">
25.93
</td>
<td style="text-align:right;">
257.71
</td>
</tr>
</tbody>

</table>
<figcaption class="figure-caption">Figure&nbsp;17: State Occupancy after Two Years</figcaption>
</figure>
</div>
</div>
<div class="page-columns page-full"><p>We see in <a href="#fig-state-2y-emb">Figure&nbsp;17</a> that after 2 years, 257.7 people (out of 1,000) have become sick, which is slightly less than the 259 who became sick after 2 years in our world without death as a competing risk. Moreover, we see that state occupancy in the <code>Sick</code> category is lower, at 242.1. This lower value reflects the fact some people had a compound transition <em>through</em> Sick and ended up dead in the same cycle. The difference (15.6) amounts to the total number of individual deaths we â€œhidâ€ in the model when we used the incorrect rate-to-probability conversion formulas.</p><div class="no-row-height column-margin column-container"><span class="">This, of course, makes sense, since there are a small number of people who die before they could become ill once we add background mortality to the model</span></div></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>